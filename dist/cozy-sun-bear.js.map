{"version":3,"file":"cozy-sun-bear.js","sources":["../src/core/Util.js","../src/core/Class.js","../src/core/Events.js","../src/core/Browser.js","../src/geometry/Point.js","../src/dom/DomEvent.Pointer.js","../src/dom/DomEvent.DoubleTap.js","../src/dom/DomEvent.js","../src/dom/DomUtil.js","../node_modules/lodash/isObject.js","../node_modules/lodash/_freeGlobal.js","../node_modules/lodash/_root.js","../node_modules/lodash/_objectToString.js","../node_modules/lodash/isObjectLike.js","../src/screenfull.js","../src/reader/Reader.js","../src/control/Control.js","../src/control/Control.Paging.js","../src/control/Modal.js","../src/control/Control.Contents.js","../src/control/Control.Title.js","../src/control/Control.PublicationMetadata.js","../src/control/Control.Preferences.js","../src/control/Control.Widget.js","../src/control/Control.Citation.js","../src/control/Control.Search.js","../src/control/Control.BibliographicInformation.js","../src/control/Control.Download.js","../src/control/Control.Navigator.js","../src/control/index.js","../src/core/Bus.js","../src/core/index.js","../src/epubjs.js","../src/reader/Reader.EpubJS.js","../src/reader/Reader.Mock.js","../src/reader/index.js","../src/cozy.js"],"sourcesContent":["/*\n * @namespace Util\n *\n * Various utility functions, used by Leaflet internally.\n */\n\n// @function extend(dest: Object, src?: Object): Object\n// Merges the properties of the `src` object (or multiple objects) into `dest` object and returns the latter. Has an `L.extend` shortcut.\nexport function extend(dest) {\n    var i, j, len, src;\n\n    for (j = 1, len = arguments.length; j < len; j++) {\n        src = arguments[j];\n        for (i in src) {\n            dest[i] = src[i];\n        }\n    }\n    return dest;\n}\n\n// @function create(proto: Object, properties?: Object): Object\n// Compatibility polyfill for [Object.create](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object/create)\nexport var create = Object.create || (function () {\n    function F() {}\n    return function (proto) {\n        F.prototype = proto;\n        return new F();\n    };\n})();\n\n// @function bind(fn: Function, …): Function\n// Returns a new function bound to the arguments passed, like [Function.prototype.bind](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Function/bind).\n// Has a `L.bind()` shortcut.\nexport function bind(fn, obj) {\n    var slice = Array.prototype.slice;\n\n    if (fn.bind) {\n        return fn.bind.apply(fn, slice.call(arguments, 1));\n    }\n\n    var args = slice.call(arguments, 2);\n\n    return function () {\n        return fn.apply(obj, args.length ? args.concat(slice.call(arguments)) : arguments);\n    };\n}\n\n// @property lastId: Number\n// Last unique ID used by [`stamp()`](#util-stamp)\nexport var lastId = 0;\n\n// @function stamp(obj: Object): Number\n// Returns the unique ID of an object, assiging it one if it doesn't have it.\nexport function stamp(obj) {\n    /*eslint-disable */\n    obj._cozy_id = obj._cozy_id || ++lastId;\n    return obj._cozy_id; /* not leaflet */\n    /*eslint-enable */\n}\n\n// @function throttle(fn: Function, time: Number, context: Object): Function\n// Returns a function which executes function `fn` with the given scope `context`\n// (so that the `this` keyword refers to `context` inside `fn`'s code). The function\n// `fn` will be called no more than one time per given amount of `time`. The arguments\n// received by the bound function will be any arguments passed when binding the\n// function, followed by any arguments passed when invoking the bound function.\n// Has an `L.throttle` shortcut.\nexport function throttle(fn, time, context) {\n    var lock, args, wrapperFn, later;\n\n    later = function () {\n        // reset lock and call if queued\n        lock = false;\n        if (args) {\n            wrapperFn.apply(context, args);\n            args = false;\n        }\n    };\n\n    wrapperFn = function () {\n        if (lock) {\n            // called too soon, queue to call later\n            args = arguments;\n\n        } else {\n            // call and lock until later\n            fn.apply(context, arguments);\n            setTimeout(later, time);\n            lock = true;\n        }\n    };\n\n    return wrapperFn;\n}\n\n// @function wrapNum(num: Number, range: Number[], includeMax?: Boolean): Number\n// Returns the number `num` modulo `range` in such a way so it lies within\n// `range[0]` and `range[1]`. The returned value will be always smaller than\n// `range[1]` unless `includeMax` is set to `true`.\nexport function wrapNum(x, range, includeMax) {\n    var max = range[1],\n        min = range[0],\n        d = max - min;\n    return x === max && includeMax ? x : ((x - min) % d + d) % d + min;\n}\n\n// @function falseFn(): Function\n// Returns a function which always returns `false`.\nexport function falseFn() { return false; }\n\n// @function formatNum(num: Number, digits?: Number): Number\n// Returns the number `num` rounded to `digits` decimals, or to 5 decimals by default.\nexport function formatNum(num, digits) {\n    var pow = Math.pow(10, digits || 5);\n    return Math.round(num * pow) / pow;\n}\n\n// @function isNumeric(num: Number): Boolean\n// Returns whether num is actually numeric\nexport function isNumeric(num) {\n  return !isNaN(parseFloat(num)) && isFinite(num);\n}\n\n// @function trim(str: String): String\n// Compatibility polyfill for [String.prototype.trim](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String/Trim)\nexport function trim(str) {\n    return str.trim ? str.trim() : str.replace(/^\\s+|\\s+$/g, '');\n}\n\n// @function splitWords(str: String): String[]\n// Trims and splits the string on whitespace and returns the array of parts.\nexport function splitWords(str) {\n    return trim(str).split(/\\s+/);\n}\n\n// @function setOptions(obj: Object, options: Object): Object\n// Merges the given properties to the `options` of the `obj` object, returning the resulting options. See `Class options`. Has an `L.setOptions` shortcut.\nexport function setOptions(obj, options) {\n    if (!obj.hasOwnProperty('options')) {\n        obj.options = obj.options ? create(obj.options) : {};\n    }\n    for (var i in options) {\n        obj.options[i] = options[i];\n    }\n    return obj.options;\n}\n\n// @function getParamString(obj: Object, existingUrl?: String, uppercase?: Boolean): String\n// Converts an object into a parameter URL string, e.g. `{a: \"foo\", b: \"bar\"}`\n// translates to `'?a=foo&b=bar'`. If `existingUrl` is set, the parameters will\n// be appended at the end. If `uppercase` is `true`, the parameter names will\n// be uppercased (e.g. `'?A=foo&B=bar'`)\nexport function getParamString(obj, existingUrl, uppercase) {\n    var params = [];\n    for (var i in obj) {\n        params.push(encodeURIComponent(uppercase ? i.toUpperCase() : i) + '=' + encodeURIComponent(obj[i]));\n    }\n    return ((!existingUrl || existingUrl.indexOf('?') === -1) ? '?' : '&') + params.join('&');\n}\n\nvar templateRe = /\\{ *([\\w_\\-]+) *\\}/g;\n\n// @function template(str: String, data: Object): String\n// Simple templating facility, accepts a template string of the form `'Hello {a}, {b}'`\n// and a data object like `{a: 'foo', b: 'bar'}`, returns evaluated string\n// `('Hello foo, bar')`. You can also specify functions instead of strings for\n// data values — they will be evaluated passing `data` as an argument.\nexport function template(str, data) {\n    return str.replace(templateRe, function (str, key) {\n        var value = data[key];\n\n        if (value === undefined) {\n            throw new Error('No value provided for variable ' + str);\n\n        } else if (typeof value === 'function') {\n            value = value(data);\n        }\n        return value;\n    });\n}\n\n// @function isArray(obj): Boolean\n// Compatibility polyfill for [Array.isArray](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray)\nexport var isArray = Array.isArray || function (obj) {\n    return (Object.prototype.toString.call(obj) === '[object Array]');\n};\n\n// @function indexOf(array: Array, el: Object): Number\n// Compatibility polyfill for [Array.prototype.indexOf](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf)\nexport function indexOf(array, el) {\n    for (var i = 0; i < array.length; i++) {\n        if (array[i] === el) { return i; }\n    }\n    return -1;\n}\n\n// @property emptyImageUrl: String\n// Data URI string containing a base64-encoded empty GIF image.\n// Used as a hack to free memory from unused images on WebKit-powered\n// mobile devices (by setting image `src` to this string).\nexport var emptyImageUrl = 'data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=';\n\n// inspired by http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n\nfunction getPrefixed(name) {\n    return window['webkit' + name] || window['moz' + name] || window['ms' + name];\n}\n\nvar lastTime = 0;\n\n// fallback for IE 7-8\nfunction timeoutDefer(fn) {\n    var time = +new Date(),\n        timeToCall = Math.max(0, 16 - (time - lastTime));\n\n    lastTime = time + timeToCall;\n    return window.setTimeout(fn, timeToCall);\n}\n\nexport var requestFn = window.requestAnimationFrame || getPrefixed('RequestAnimationFrame') || timeoutDefer;\nexport var cancelFn = window.cancelAnimationFrame || getPrefixed('CancelAnimationFrame') ||\n        getPrefixed('CancelRequestAnimationFrame') || function (id) { window.clearTimeout(id); };\n\n// @function requestAnimFrame(fn: Function, context?: Object, immediate?: Boolean): Number\n// Schedules `fn` to be executed when the browser repaints. `fn` is bound to\n// `context` if given. When `immediate` is set, `fn` is called immediately if\n// the browser doesn't have native support for\n// [`window.requestAnimationFrame`](https://developer.mozilla.org/docs/Web/API/window/requestAnimationFrame),\n// otherwise it's delayed. Returns a request ID that can be used to cancel the request.\nexport function requestAnimFrame(fn, context, immediate) {\n    if (immediate && requestFn === timeoutDefer) {\n        fn.call(context);\n    } else {\n        return requestFn.call(window, bind(fn, context));\n    }\n}\n\n// @function cancelAnimFrame(id: Number): undefined\n// Cancels a previous `requestAnimFrame`. See also [window.cancelAnimationFrame](https://developer.mozilla.org/docs/Web/API/window/cancelAnimationFrame).\nexport function cancelAnimFrame(id) {\n    if (id) {\n        cancelFn.call(window, id);\n    }\n}\n\nexport var loader = {\n    js: function(url) {\n        var handler = {};\n        handler.callbacks = [];\n        handler.error = [];\n        handler.then = function(cb) {\n            handler.callbacks.push(cb);\n            return handler;\n        }\n        handler.catch = function(cb) {\n            handler.error.push(cb);\n            return handler;\n        }\n        handler.resolve = function(_argv) {\n            // var _argv;\n            while ( handler.callbacks.length ) {\n                var cb = handler.callbacks.shift();\n                var retval;\n                try {\n                    _argv = cb(_argv);\n                } catch(e) {\n                    handler.reject(e);\n                    break;\n                }\n            }\n        }\n\n        handler.reject = function(e) {\n            while ( handler.error.length ) {\n                var cb = handler.error.shift();\n                cb(e);\n            }\n            console.log(e);\n            console.trace();\n        }\n\n        if ( url == undefined ) {\n            setTimeout(function() {\n                handler.resolve(url);\n            }, 0);\n            return handler;\n        }\n\n        var element = document.createElement('script');\n\n        element.onload = function() {\n          handler.resolve(url);\n        };\n        element.onerror = function() {\n          handler.catch.apply(arguments);\n        };\n\n        element.async = true;\n        var parent = 'body';\n        var attr = 'src';\n        element[attr] = url;\n        document[parent].appendChild(element);\n\n        console.log(\"AHOY APPENDED\", url);\n\n        return handler;\n    }\n}","import * as Util from './Util';\r\n\r\n// @class Class\r\n// @aka L.Class\r\n\r\n// @section\r\n// @uninheritable\r\n\r\n// Thanks to John Resig and Dean Edwards for inspiration!\r\n\r\nexport function Class() {}\r\n\r\nClass.extend = function (props) {\r\n\r\n\t// @function extend(props: Object): Function\r\n\t// [Extends the current class](#class-inheritance) given the properties to be included.\r\n\t// Returns a Javascript function that is a class constructor (to be called with `new`).\r\n\tvar NewClass = function () {\r\n\r\n\t\t// call the constructor\r\n\t\tif (this.initialize) {\r\n\t\t\tthis.initialize.apply(this, arguments);\r\n\t\t}\r\n\r\n\t\t// call all constructor hooks\r\n\t\tthis.callInitHooks();\r\n\t};\r\n\r\n\tvar parentProto = NewClass.__super__ = this.prototype;\r\n\r\n\tvar proto = Util.create(parentProto);\r\n\tproto.constructor = NewClass;\r\n\r\n\tNewClass.prototype = proto;\r\n\r\n\t// inherit parent's statics\r\n\tfor (var i in this) {\r\n\t\tif (this.hasOwnProperty(i) && i !== 'prototype') {\r\n\t\t\tNewClass[i] = this[i];\r\n\t\t}\r\n\t}\r\n\r\n\t// mix static properties into the class\r\n\tif (props.statics) {\r\n\t\tUtil.extend(NewClass, props.statics);\r\n\t\tdelete props.statics;\r\n\t}\r\n\r\n\t// mix includes into the prototype\r\n\tif (props.includes) {\r\n\t\tcheckDeprecatedMixinEvents(props.includes);\r\n\t\tUtil.extend.apply(null, [proto].concat(props.includes));\r\n\t\tdelete props.includes;\r\n\t}\r\n\r\n\t// merge options\r\n\tif (proto.options) {\r\n\t\tprops.options = Util.extend(Util.create(proto.options), props.options);\r\n\t}\r\n\r\n\t// mix given properties into the prototype\r\n\tUtil.extend(proto, props);\r\n\t\r\n\tproto._initHooks = [];\r\n\r\n\t// add method for calling all hooks\r\n\tproto.callInitHooks = function () {\r\n\r\n\t\tif (this._initHooksCalled) { return; }\r\n\r\n\t\tif (parentProto.callInitHooks) {\r\n\t\t\tparentProto.callInitHooks.call(this);\r\n\t\t}\r\n\r\n\t\tthis._initHooksCalled = true;\r\n\r\n\t\tfor (var i = 0, len = proto._initHooks.length; i < len; i++) {\r\n\t\t\tproto._initHooks[i].call(this);\r\n\t\t}\r\n\t};\r\n\r\n\treturn NewClass;\r\n};\r\n\r\n\r\n// @function include(properties: Object): this\r\n// [Includes a mixin](#class-includes) into the current class.\r\nClass.include = function (props) {\r\n\tUtil.extend(this.prototype, props);\r\n\treturn this;\r\n};\r\n\r\n// @function mergeOptions(options: Object): this\r\n// [Merges `options`](#class-options) into the defaults of the class.\r\nClass.mergeOptions = function (options) {\r\n\tUtil.extend(this.prototype.options, options);\r\n\treturn this;\r\n};\r\n\r\n// @function addInitHook(fn: Function): this\r\n// Adds a [constructor hook](#class-constructor-hooks) to the class.\r\nClass.addInitHook = function (fn) { // (Function) || (String, args...)\r\n\tvar args = Array.prototype.slice.call(arguments, 1);\r\n\r\n\tvar init = typeof fn === 'function' ? fn : function () {\r\n\t\tthis[fn].apply(this, args);\r\n\t};\r\n\r\n\tthis.prototype._initHooks = this.prototype._initHooks || [];\r\n\tthis.prototype._initHooks.push(init);\r\n\treturn this;\r\n};\r\n\r\nfunction checkDeprecatedMixinEvents(includes) {\r\n\tif (!cozy || !cozy.Mixin) { return; }\r\n\r\n\tincludes = cozy.Util.isArray(includes) ? includes : [includes];\r\n\r\n\t// for (var i = 0; i < includes.length; i++) {\r\n\t// \tif (includes[i] === cozy.Mixin.Events) {\r\n\t// \t\tconsole.warn('Deprecated include of cozy.Mixin.Events: ' +\r\n\t// \t\t\t'this property will be removed in future releases, ' +\r\n\t// \t\t\t'please inherit from cozy.Evented instead.', new Error().stack);\r\n\t// \t}\r\n\t// }\r\n}\r\n","import {Class} from './Class';\r\nimport * as Util from './Util';\r\n\r\n/*\r\n * @class Evented\r\n * @aka L.Evented\r\n * @inherits Class\r\n *\r\n * A set of methods shared between event-powered classes (like `Map` and `Marker`). Generally, events allow you to execute some function when something happens with an object (e.g. the user clicks on the map, causing the map to fire `'click'` event).\r\n *\r\n * @example\r\n *\r\n * ```js\r\n * map.on('click', function(e) {\r\n * \talert(e.latlng);\r\n * } );\r\n * ```\r\n *\r\n * Leaflet deals with event listeners by reference, so if you want to add a listener and then remove it, define it as a function:\r\n *\r\n * ```js\r\n * function onClick(e) { ... }\r\n *\r\n * map.on('click', onClick);\r\n * map.off('click', onClick);\r\n * ```\r\n */\r\n\r\nexport var Evented = Class.extend({\r\n\r\n\t/* @method on(type: String, fn: Function, context?: Object): this\r\n\t * Adds a listener function (`fn`) to a particular event type of the object. You can optionally specify the context of the listener (object the this keyword will point to). You can also pass several space-separated types (e.g. `'click dblclick'`).\r\n\t *\r\n\t * @alternative\r\n\t * @method on(eventMap: Object): this\r\n\t * Adds a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`\r\n\t */\r\n\ton: function (types, fn, context) {\r\n\r\n\t\t// types can be a map of types/handlers\r\n\t\tif (typeof types === 'object') {\r\n\t\t\tfor (var type in types) {\r\n\t\t\t\t// we don't process space-separated events here for performance;\r\n\t\t\t\t// it's a hot path since Layer uses the on(obj) syntax\r\n\t\t\t\tthis._on(type, types[type], fn);\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\t// types can be a string of space-separated words\r\n\t\t\ttypes = Util.splitWords(types);\r\n\r\n\t\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\t\tthis._on(types[i], fn, context);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t/* @method off(type: String, fn?: Function, context?: Object): this\r\n\t * Removes a previously added listener function. If no function is specified, it will remove all the listeners of that particular event from the object. Note that if you passed a custom context to `on`, you must pass the same context to `off` in order to remove the listener.\r\n\t *\r\n\t * @alternative\r\n\t * @method off(eventMap: Object): this\r\n\t * Removes a set of type/listener pairs.\r\n\t *\r\n\t * @alternative\r\n\t * @method off: this\r\n\t * Removes all listeners to all events on the object.\r\n\t */\r\n\toff: function (types, fn, context) {\r\n\r\n\t\tif (!types) {\r\n\t\t\t// clear all listeners if called without arguments\r\n\t\t\tdelete this._events;\r\n\r\n\t\t} else if (typeof types === 'object') {\r\n\t\t\tfor (var type in types) {\r\n\t\t\t\tthis._off(type, types[type], fn);\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\ttypes = Util.splitWords(types);\r\n\r\n\t\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\t\tthis._off(types[i], fn, context);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// attach listener (without syntactic sugar now)\r\n\t_on: function (type, fn, context) {\r\n\t\tthis._events = this._events || {};\r\n\r\n\t\t/* get/init listeners for type */\r\n\t\tvar typeListeners = this._events[type];\r\n\t\tif (!typeListeners) {\r\n\t\t\ttypeListeners = [];\r\n\t\t\tthis._events[type] = typeListeners;\r\n\t\t}\r\n\r\n\t\tif (context === this) {\r\n\t\t\t// Less memory footprint.\r\n\t\t\tcontext = undefined;\r\n\t\t}\r\n\t\tvar newListener = {fn: fn, ctx: context},\r\n\t\t    listeners = typeListeners;\r\n\r\n\t\t// check if fn already there\r\n\t\tfor (var i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\tif (listeners[i].fn === fn && listeners[i].ctx === context) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlisteners.push(newListener);\r\n\t},\r\n\r\n\t_off: function (type, fn, context) {\r\n\t\tvar listeners,\r\n\t\t    i,\r\n\t\t    len;\r\n\r\n\t\tif (!this._events) { return; }\r\n\r\n\t\tlisteners = this._events[type];\r\n\r\n\t\tif (!listeners) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!fn) {\r\n\t\t\t// Set all removed listeners to noop so they are not called if remove happens in fire\r\n\t\t\tfor (i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\tlisteners[i].fn = Util.falseFn;\r\n\t\t\t}\r\n\t\t\t// clear all listeners for a type if function isn't specified\r\n\t\t\tdelete this._events[type];\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (context === this) {\r\n\t\t\tcontext = undefined;\r\n\t\t}\r\n\r\n\t\tif (listeners) {\r\n\r\n\t\t\t// find fn and remove it\r\n\t\t\tfor (i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\tvar l = listeners[i];\r\n\t\t\t\tif (l.ctx !== context) { continue; }\r\n\t\t\t\tif (l.fn === fn) {\r\n\r\n\t\t\t\t\t// set the removed listener to noop so that's not called if remove happens in fire\r\n\t\t\t\t\tl.fn = Util.falseFn;\r\n\r\n\t\t\t\t\tif (this._firingCount) {\r\n\t\t\t\t\t\t/* copy array in case events are being fired */\r\n\t\t\t\t\t\tthis._events[type] = listeners = listeners.slice();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlisteners.splice(i, 1);\r\n\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\t// @method fire(type: String, data?: Object, propagate?: Boolean): this\r\n\t// Fires an event of the specified type. You can optionally provide an data\r\n\t// object — the first argument of the listener function will contain its\r\n\t// properties. The event can optionally be propagated to event parents.\r\n\tfire: function (type, data, propagate) {\r\n\t\tif (!this.listens(type, propagate)) { return this; }\r\n\r\n\t\tvar event = Util.extend({}, data, {type: type, target: this});\r\n\r\n\t\tif (this._events) {\r\n\t\t\tvar listeners = this._events[type];\r\n\r\n\t\t\tif (listeners) {\r\n\t\t\t\tthis._firingCount = (this._firingCount + 1) || 1;\r\n\t\t\t\tfor (var i = 0, len = listeners.length; i < len; i++) {\r\n\t\t\t\t\tvar l = listeners[i];\r\n\t\t\t\t\tl.fn.call(l.ctx || this, event);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._firingCount--;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (propagate) {\r\n\t\t\t// propagate the event to parents (set with addEventParent)\r\n\t\t\tthis._propagateEvent(event);\r\n\t\t}\r\n\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method listens(type: String): Boolean\r\n\t// Returns `true` if a particular event type has any listeners attached to it.\r\n\tlistens: function (type, propagate) {\r\n\t\tvar listeners = this._events && this._events[type];\r\n\t\tif (listeners && listeners.length) { return true; }\r\n\r\n\t\tif (propagate) {\r\n\t\t\t// also check parents for listeners if event propagates\r\n\t\t\tfor (var id in this._eventParents) {\r\n\t\t\t\tif (this._eventParents[id].listens(type, propagate)) { return true; }\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\r\n\t// @method once(…): this\r\n\t// Behaves as [`on(…)`](#evented-on), except the listener will only get fired once and then removed.\r\n\tonce: function (types, fn, context) {\r\n\r\n\t\tif (typeof types === 'object') {\r\n\t\t\tfor (var type in types) {\r\n\t\t\t\tthis.once(type, types[type], fn);\r\n\t\t\t}\r\n\t\t\treturn this;\r\n\t\t}\r\n\r\n\t\tvar handler = Util.bind(function () {\r\n\t\t\tthis\r\n\t\t\t    .off(types, fn, context)\r\n\t\t\t    .off(types, handler, context);\r\n\t\t}, this);\r\n\r\n\t\t// add a listener that's executed once and removed after that\r\n\t\treturn this\r\n\t\t    .on(types, fn, context)\r\n\t\t    .on(types, handler, context);\r\n\t},\r\n\r\n\t// @method addEventParent(obj: Evented): this\r\n\t// Adds an event parent - an `Evented` that will receive propagated events\r\n\taddEventParent: function (obj) {\r\n\t\tthis._eventParents = this._eventParents || {};\r\n\t\tthis._eventParents[Util.stamp(obj)] = obj;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method removeEventParent(obj: Evented): this\r\n\t// Removes an event parent, so it will stop receiving propagated events\r\n\tremoveEventParent: function (obj) {\r\n\t\tif (this._eventParents) {\r\n\t\t\tdelete this._eventParents[Util.stamp(obj)];\r\n\t\t}\r\n\t\treturn this;\r\n\t},\r\n\r\n\t_propagateEvent: function (e) {\r\n\t\tfor (var id in this._eventParents) {\r\n\t\t\tthis._eventParents[id].fire(e.type, Util.extend({layer: e.target}, e), true);\r\n\t\t}\r\n\t}\r\n});\r\n\r\nvar proto = Evented.prototype;\r\n\r\n// aliases; we should ditch those eventually\r\n\r\n// @method addEventListener(…): this\r\n// Alias to [`on(…)`](#evented-on)\r\nproto.addEventListener = proto.on;\r\n\r\n// @method removeEventListener(…): this\r\n// Alias to [`off(…)`](#evented-off)\r\n\r\n// @method clearAllEventListeners(…): this\r\n// Alias to [`off()`](#evented-off)\r\nproto.removeEventListener = proto.clearAllEventListeners = proto.off;\r\n\r\n// @method addOneTimeEventListener(…): this\r\n// Alias to [`once(…)`](#evented-once)\r\nproto.addOneTimeEventListener = proto.once;\r\n\r\n// @method fireEvent(…): this\r\n// Alias to [`fire(…)`](#evented-fire)\r\nproto.fireEvent = proto.fire;\r\n\r\n// @method hasEventListeners(…): Boolean\r\n// Alias to [`listens(…)`](#evented-listens)\r\nproto.hasEventListeners = proto.listens;\r\n","\n/*\n * @namespace Browser\n * @aka L.Browser\n *\n * A namespace with static properties for browser/feature detection used by Leaflet internally.\n *\n * @example\n *\n * ```js\n * if (L.Browser.ielt9) {\n *   alert('Upgrade your browser, dude!');\n * }\n * ```\n */\n\nvar style = document.documentElement.style;\n\n// @property ie: Boolean; `true` for all Internet Explorer versions (not Edge).\nexport var ie = 'ActiveXObject' in window;\n\n// @property ielt9: Boolean; `true` for Internet Explorer versions less than 9.\nexport var ielt9 = ie && !document.addEventListener;\n\n// @property edge: Boolean; `true` for the Edge web browser.\nexport var edge = 'msLaunchUri' in navigator && !('documentMode' in document);\n\n// @property webkit: Boolean;\n// `true` for webkit-based browsers like Chrome and Safari (including mobile versions).\nexport var webkit = userAgentContains('webkit');\n\n// @property android: Boolean\n// `true` for any browser running on an Android platform.\nexport var android = userAgentContains('android');\n\n// @property android23: Boolean; `true` for browsers running on Android 2 or Android 3.\nexport var android23 = userAgentContains('android 2') || userAgentContains('android 3');\n\n// @property opera: Boolean; `true` for the Opera browser\nexport var opera = !!window.opera;\n\n// @property chrome: Boolean; `true` for the Chrome browser.\nexport var chrome = userAgentContains('chrome');\n\n// @property gecko: Boolean; `true` for gecko-based browsers like Firefox.\nexport var gecko = userAgentContains('gecko') && !webkit && !opera && !ie;\n\n// @property safari: Boolean; `true` for the Safari browser.\nexport var safari = !chrome && userAgentContains('safari');\n\nexport var phantom = userAgentContains('phantom');\n\n// @property opera12: Boolean\n// `true` for the Opera browser supporting CSS transforms (version 12 or later).\nexport var opera12 = 'OTransition' in style;\n\n// @property win: Boolean; `true` when the browser is running in a Windows platform\nexport var win = navigator.platform.indexOf('Win') === 0;\n\n// @property ie3d: Boolean; `true` for all Internet Explorer versions supporting CSS transforms.\nexport var ie3d = ie && ('transition' in style);\n\n// @property webkit3d: Boolean; `true` for webkit-based browsers supporting CSS transforms.\nexport var webkit3d = ('WebKitCSSMatrix' in window) && ('m11' in new window.WebKitCSSMatrix()) && !android23;\n\n// @property gecko3d: Boolean; `true` for gecko-based browsers supporting CSS transforms.\nexport var gecko3d = 'MozPerspective' in style;\n\n// @property any3d: Boolean\n// `true` for all browsers supporting CSS transforms.\nexport var any3d = !window.L_DISABLE_3D && (ie3d || webkit3d || gecko3d) && !opera12 && !phantom;\n\n// @property mobile: Boolean; `true` for all browsers running in a mobile device.\nexport var mobile = typeof orientation !== 'undefined' || userAgentContains('mobile');\n\n// @property mobileWebkit: Boolean; `true` for all webkit-based browsers in a mobile device.\nexport var mobileWebkit = mobile && webkit;\n\n// @property mobileWebkit3d: Boolean\n// `true` for all webkit-based browsers in a mobile device supporting CSS transforms.\nexport var mobileWebkit3d = mobile && webkit3d;\n\n// @property msPointer: Boolean\n// `true` for browsers implementing the Microsoft touch events model (notably IE10).\nexport var msPointer = !window.PointerEvent && window.MSPointerEvent;\n\n// @property pointer: Boolean\n// `true` for all browsers supporting [pointer events](https://msdn.microsoft.com/en-us/library/dn433244%28v=vs.85%29.aspx).\nexport var pointer = !!(window.PointerEvent || msPointer);\n\n// @property touch: Boolean\n// `true` for all browsers supporting [touch events](https://developer.mozilla.org/docs/Web/API/Touch_events).\n// This does not necessarily mean that the browser is running in a computer with\n// a touchscreen, it only means that the browser is capable of understanding\n// touch events.\nexport var touch = !window.L_NO_TOUCH && (pointer || 'ontouchstart' in window ||\n        (window.DocumentTouch && document instanceof window.DocumentTouch));\n\n// @property mobileOpera: Boolean; `true` for the Opera browser in a mobile device.\nexport var mobileOpera = mobile && opera;\n\n// @property mobileGecko: Boolean\n// `true` for gecko-based browsers running in a mobile device.\nexport var mobileGecko = mobile && gecko;\n\n// @property retina: Boolean\n// `true` for browsers on a high-resolution \"retina\" screen.\nexport var retina = (window.devicePixelRatio || (window.screen.deviceXDPI / window.screen.logicalXDPI)) > 1;\n\n\n// @property canvas: Boolean\n// `true` when the browser supports [`<canvas>`](https://developer.mozilla.org/docs/Web/API/Canvas_API).\nexport var canvas = (function () {\n    return !!document.createElement('canvas').getContext;\n}());\n\n// @property svg: Boolean\n// `true` when the browser supports [SVG](https://developer.mozilla.org/docs/Web/SVG).\n// export var svg = !!(document.createElementNS && svgCreate('svg').createSVGRect);\nexport var svg = true;\n\n// @property vml: Boolean\n// `true` if the browser supports [VML](https://en.wikipedia.org/wiki/Vector_Markup_Language).\nexport var vml = !svg && (function () {\n    try {\n        var div = document.createElement('div');\n        div.innerHTML = '<v:shape adj=\"1\"/>';\n\n        var shape = div.firstChild;\n        shape.style.behavior = 'url(#default#VML)';\n\n        return shape && (typeof shape.adj === 'object');\n\n    } catch (e) {\n        return false;\n    }\n}());\n\nexport var columnCount = ( 'columnCount' in style );\nexport var classList = ( document.documentElement.classList !== undefined );\n\nfunction userAgentContains(str) {\n    return navigator.userAgent.toLowerCase().indexOf(str) >= 0;\n}\n","import {isArray, formatNum} from '../core/Util';\r\n\r\n/*\r\n * @class Point\r\n * @aka L.Point\r\n *\r\n * Represents a point with `x` and `y` coordinates in pixels.\r\n *\r\n * @example\r\n *\r\n * ```js\r\n * var point = L.point(200, 300);\r\n * ```\r\n *\r\n * All Leaflet methods and options that accept `Point` objects also accept them in a simple Array form (unless noted otherwise), so these lines are equivalent:\r\n *\r\n * ```js\r\n * map.panBy([200, 300]);\r\n * map.panBy(L.point(200, 300));\r\n * ```\r\n */\r\n\r\nexport function Point(x, y, round) {\r\n\t// @property x: Number; The `x` coordinate of the point\r\n\tthis.x = (round ? Math.round(x) : x);\r\n\t// @property y: Number; The `y` coordinate of the point\r\n\tthis.y = (round ? Math.round(y) : y);\r\n}\r\n\r\nPoint.prototype = {\r\n\r\n\t// @method clone(): Point\r\n\t// Returns a copy of the current point.\r\n\tclone: function () {\r\n\t\treturn new Point(this.x, this.y);\r\n\t},\r\n\r\n\t// @method add(otherPoint: Point): Point\r\n\t// Returns the result of addition of the current and the given points.\r\n\tadd: function (point) {\r\n\t\t// non-destructive, returns a new point\r\n\t\treturn this.clone()._add(toPoint(point));\r\n\t},\r\n\r\n\t_add: function (point) {\r\n\t\t// destructive, used directly for performance in situations where it's safe to modify existing point\r\n\t\tthis.x += point.x;\r\n\t\tthis.y += point.y;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method subtract(otherPoint: Point): Point\r\n\t// Returns the result of subtraction of the given point from the current.\r\n\tsubtract: function (point) {\r\n\t\treturn this.clone()._subtract(toPoint(point));\r\n\t},\r\n\r\n\t_subtract: function (point) {\r\n\t\tthis.x -= point.x;\r\n\t\tthis.y -= point.y;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method divideBy(num: Number): Point\r\n\t// Returns the result of division of the current point by the given number.\r\n\tdivideBy: function (num) {\r\n\t\treturn this.clone()._divideBy(num);\r\n\t},\r\n\r\n\t_divideBy: function (num) {\r\n\t\tthis.x /= num;\r\n\t\tthis.y /= num;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method multiplyBy(num: Number): Point\r\n\t// Returns the result of multiplication of the current point by the given number.\r\n\tmultiplyBy: function (num) {\r\n\t\treturn this.clone()._multiplyBy(num);\r\n\t},\r\n\r\n\t_multiplyBy: function (num) {\r\n\t\tthis.x *= num;\r\n\t\tthis.y *= num;\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method scaleBy(scale: Point): Point\r\n\t// Multiply each coordinate of the current point by each coordinate of\r\n\t// `scale`. In linear algebra terms, multiply the point by the\r\n\t// [scaling matrix](https://en.wikipedia.org/wiki/Scaling_%28geometry%29#Matrix_representation)\r\n\t// defined by `scale`.\r\n\tscaleBy: function (point) {\r\n\t\treturn new Point(this.x * point.x, this.y * point.y);\r\n\t},\r\n\r\n\t// @method unscaleBy(scale: Point): Point\r\n\t// Inverse of `scaleBy`. Divide each coordinate of the current point by\r\n\t// each coordinate of `scale`.\r\n\tunscaleBy: function (point) {\r\n\t\treturn new Point(this.x / point.x, this.y / point.y);\r\n\t},\r\n\r\n\t// @method round(): Point\r\n\t// Returns a copy of the current point with rounded coordinates.\r\n\tround: function () {\r\n\t\treturn this.clone()._round();\r\n\t},\r\n\r\n\t_round: function () {\r\n\t\tthis.x = Math.round(this.x);\r\n\t\tthis.y = Math.round(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method floor(): Point\r\n\t// Returns a copy of the current point with floored coordinates (rounded down).\r\n\tfloor: function () {\r\n\t\treturn this.clone()._floor();\r\n\t},\r\n\r\n\t_floor: function () {\r\n\t\tthis.x = Math.floor(this.x);\r\n\t\tthis.y = Math.floor(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method ceil(): Point\r\n\t// Returns a copy of the current point with ceiled coordinates (rounded up).\r\n\tceil: function () {\r\n\t\treturn this.clone()._ceil();\r\n\t},\r\n\r\n\t_ceil: function () {\r\n\t\tthis.x = Math.ceil(this.x);\r\n\t\tthis.y = Math.ceil(this.y);\r\n\t\treturn this;\r\n\t},\r\n\r\n\t// @method distanceTo(otherPoint: Point): Number\r\n\t// Returns the cartesian distance between the current and the given points.\r\n\tdistanceTo: function (point) {\r\n\t\tpoint = toPoint(point);\r\n\r\n\t\tvar x = point.x - this.x,\r\n\t\t    y = point.y - this.y;\r\n\r\n\t\treturn Math.sqrt(x * x + y * y);\r\n\t},\r\n\r\n\t// @method equals(otherPoint: Point): Boolean\r\n\t// Returns `true` if the given point has the same coordinates.\r\n\tequals: function (point) {\r\n\t\tpoint = toPoint(point);\r\n\r\n\t\treturn point.x === this.x &&\r\n\t\t       point.y === this.y;\r\n\t},\r\n\r\n\t// @method contains(otherPoint: Point): Boolean\r\n\t// Returns `true` if both coordinates of the given point are less than the corresponding current point coordinates (in absolute values).\r\n\tcontains: function (point) {\r\n\t\tpoint = toPoint(point);\r\n\r\n\t\treturn Math.abs(point.x) <= Math.abs(this.x) &&\r\n\t\t       Math.abs(point.y) <= Math.abs(this.y);\r\n\t},\r\n\r\n\t// @method toString(): String\r\n\t// Returns a string representation of the point for debugging purposes.\r\n\ttoString: function () {\r\n\t\treturn 'Point(' +\r\n\t\t        formatNum(this.x) + ', ' +\r\n\t\t        formatNum(this.y) + ')';\r\n\t}\r\n};\r\n\r\n// @factory L.point(x: Number, y: Number, round?: Boolean)\r\n// Creates a Point object with the given `x` and `y` coordinates. If optional `round` is set to true, rounds the `x` and `y` values.\r\n\r\n// @alternative\r\n// @factory L.point(coords: Number[])\r\n// Expects an array of the form `[x, y]` instead.\r\n\r\n// @alternative\r\n// @factory L.point(coords: Object)\r\n// Expects a plain object of the form `{x: Number, y: Number}` instead.\r\nexport function toPoint(x, y, round) {\r\n\tif (x instanceof Point) {\r\n\t\treturn x;\r\n\t}\r\n\tif (isArray(x)) {\r\n\t\treturn new Point(x[0], x[1]);\r\n\t}\r\n\tif (x === undefined || x === null) {\r\n\t\treturn x;\r\n\t}\r\n\tif (typeof x === 'object' && 'x' in x && 'y' in x) {\r\n\t\treturn new Point(x.x, x.y);\r\n\t}\r\n\treturn new Point(x, y, round);\r\n}\r\n","import * as DomEvent from './DomEvent';\nimport * as Util from '../core/Util';\nimport * as Browser from '../core/Browser';\n\n/*\n * Extends L.DomEvent to provide touch support for Internet Explorer and Windows-based devices.\n */\n\n\nvar POINTER_DOWN =   Browser.msPointer ? 'MSPointerDown'   : 'pointerdown',\n    POINTER_MOVE =   Browser.msPointer ? 'MSPointerMove'   : 'pointermove',\n    POINTER_UP =     Browser.msPointer ? 'MSPointerUp'     : 'pointerup',\n    POINTER_CANCEL = Browser.msPointer ? 'MSPointerCancel' : 'pointercancel',\n    TAG_WHITE_LIST = ['INPUT', 'SELECT', 'OPTION'],\n\n    _pointers = {},\n    _pointerDocListener = false;\n\n// DomEvent.DoubleTap needs to know about this\nexport var _pointersCount = 0;\n\n// Provides a touch events wrapper for (ms)pointer events.\n// ref http://www.w3.org/TR/pointerevents/ https://www.w3.org/Bugs/Public/show_bug.cgi?id=22890\n\nexport function addPointerListener(obj, type, handler, id) {\n\tif (type === 'touchstart') {\n\t\t_addPointerStart(obj, handler, id);\n\n\t} else if (type === 'touchmove') {\n\t\t_addPointerMove(obj, handler, id);\n\n\t} else if (type === 'touchend') {\n\t\t_addPointerEnd(obj, handler, id);\n\t}\n\n\treturn this;\n}\n\nexport function removePointerListener(obj, type, id) {\n\tvar handler = obj['_leaflet_' + type + id];\n\n\tif (type === 'touchstart') {\n\t\tobj.removeEventListener(POINTER_DOWN, handler, false);\n\n\t} else if (type === 'touchmove') {\n\t\tobj.removeEventListener(POINTER_MOVE, handler, false);\n\n\t} else if (type === 'touchend') {\n\t\tobj.removeEventListener(POINTER_UP, handler, false);\n\t\tobj.removeEventListener(POINTER_CANCEL, handler, false);\n\t}\n\n\treturn this;\n}\n\nfunction _addPointerStart(obj, handler, id) {\n\tvar onDown = Util.bind(function (e) {\n\t\tif (e.pointerType !== 'mouse' && e.pointerType !== e.MSPOINTER_TYPE_MOUSE && e.pointerType !== e.MSPOINTER_TYPE_MOUSE) {\n\t\t\t// In IE11, some touch events needs to fire for form controls, or\n\t\t\t// the controls will stop working. We keep a whitelist of tag names that\n\t\t\t// need these events. For other target tags, we prevent default on the event.\n\t\t\tif (TAG_WHITE_LIST.indexOf(e.target.tagName) < 0) {\n\t\t\t\tDomEvent.preventDefault(e);\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t_handlePointer(e, handler);\n\t});\n\n\tobj['_leaflet_touchstart' + id] = onDown;\n\tobj.addEventListener(POINTER_DOWN, onDown, false);\n\n\t// need to keep track of what pointers and how many are active to provide e.touches emulation\n\tif (!_pointerDocListener) {\n\t\t// we listen documentElement as any drags that end by moving the touch off the screen get fired there\n\t\tdocument.documentElement.addEventListener(POINTER_DOWN, _globalPointerDown, true);\n\t\tdocument.documentElement.addEventListener(POINTER_MOVE, _globalPointerMove, true);\n\t\tdocument.documentElement.addEventListener(POINTER_UP, _globalPointerUp, true);\n\t\tdocument.documentElement.addEventListener(POINTER_CANCEL, _globalPointerUp, true);\n\n\t\t_pointerDocListener = true;\n\t}\n}\n\nfunction _globalPointerDown(e) {\n\t_pointers[e.pointerId] = e;\n\t_pointersCount++;\n}\n\nfunction _globalPointerMove(e) {\n\tif (_pointers[e.pointerId]) {\n\t\t_pointers[e.pointerId] = e;\n\t}\n}\n\nfunction _globalPointerUp(e) {\n\tdelete _pointers[e.pointerId];\n\t_pointersCount--;\n}\n\nfunction _handlePointer(e, handler) {\n\te.touches = [];\n\tfor (var i in _pointers) {\n\t\te.touches.push(_pointers[i]);\n\t}\n\te.changedTouches = [e];\n\n\thandler(e);\n}\n\nfunction _addPointerMove(obj, handler, id) {\n\tvar onMove = function (e) {\n\t\t// don't fire touch moves when mouse isn't down\n\t\tif ((e.pointerType === e.MSPOINTER_TYPE_MOUSE || e.pointerType === 'mouse') && e.buttons === 0) { return; }\n\n\t\t_handlePointer(e, handler);\n\t};\n\n\tobj['_leaflet_touchmove' + id] = onMove;\n\tobj.addEventListener(POINTER_MOVE, onMove, false);\n}\n\nfunction _addPointerEnd(obj, handler, id) {\n\tvar onUp = function (e) {\n\t\t_handlePointer(e, handler);\n\t};\n\n\tobj['_leaflet_touchend' + id] = onUp;\n\tobj.addEventListener(POINTER_UP, onUp, false);\n\tobj.addEventListener(POINTER_CANCEL, onUp, false);\n}\n\n","import * as Browser from '../core/Browser';\r\nimport {_pointersCount} from './DomEvent.Pointer';\r\n\r\n/*\r\n * Extends the event handling code with double tap support for mobile browsers.\r\n */\r\n\r\nvar _touchstart = Browser.msPointer ? 'MSPointerDown' : Browser.pointer ? 'pointerdown' : 'touchstart',\r\n    _touchend = Browser.msPointer ? 'MSPointerUp' : Browser.pointer ? 'pointerup' : 'touchend',\r\n    _pre = '_leaflet_';\r\n\r\n// inspired by Zepto touch code by Thomas Fuchs\r\nexport function addDoubleTapListener(obj, handler, id) {\r\n\tvar last, touch,\r\n\t    doubleTap = false,\r\n\t    delay = 250;\r\n\r\n\tfunction onTouchStart(e) {\r\n\t\tvar count;\r\n\r\n\t\tif (Browser.pointer) {\r\n\t\t\tif ((!Browser.edge) || e.pointerType === 'mouse') { return; }\r\n\t\t\tcount = _pointersCount;\r\n\t\t} else {\r\n\t\t\tcount = e.touches.length;\r\n\t\t}\r\n\r\n\t\tif (count > 1) { return; }\r\n\r\n\t\tvar now = Date.now(),\r\n\t\t    delta = now - (last || now);\r\n\r\n\t\ttouch = e.touches ? e.touches[0] : e;\r\n\t\tdoubleTap = (delta > 0 && delta <= delay);\r\n\t\tlast = now;\r\n\t}\r\n\r\n\tfunction onTouchEnd(e) {\r\n\t\tif (doubleTap && !touch.cancelBubble) {\r\n\t\t\tif (Browser.pointer) {\r\n\t\t\t\tif ((!Browser.edge) || e.pointerType === 'mouse') { return; }\r\n\t\t\t\t// work around .type being readonly with MSPointer* events\r\n\t\t\t\tvar newTouch = {},\r\n\t\t\t\t    prop, i;\r\n\r\n\t\t\t\tfor (i in touch) {\r\n\t\t\t\t\tprop = touch[i];\r\n\t\t\t\t\tnewTouch[i] = prop && prop.bind ? prop.bind(touch) : prop;\r\n\t\t\t\t}\r\n\t\t\t\ttouch = newTouch;\r\n\t\t\t}\r\n\t\t\ttouch.type = 'dblclick';\r\n\t\t\thandler(touch);\r\n\t\t\tlast = null;\r\n\t\t}\r\n\t}\r\n\r\n\tobj[_pre + _touchstart + id] = onTouchStart;\r\n\tobj[_pre + _touchend + id] = onTouchEnd;\r\n\tobj[_pre + 'dblclick' + id] = handler;\r\n\r\n\tobj.addEventListener(_touchstart, onTouchStart, false);\r\n\tobj.addEventListener(_touchend, onTouchEnd, false);\r\n\r\n\t// On some platforms (notably, chrome<55 on win10 + touchscreen + mouse),\r\n\t// the browser doesn't fire touchend/pointerup events but does fire\r\n\t// native dblclicks. See #4127.\r\n\t// Edge 14 also fires native dblclicks, but only for pointerType mouse, see #5180.\r\n\tobj.addEventListener('dblclick', handler, false);\r\n\r\n\treturn this;\r\n}\r\n\r\nexport function removeDoubleTapListener(obj, id) {\r\n\tvar touchstart = obj[_pre + _touchstart + id],\r\n\t    touchend = obj[_pre + _touchend + id],\r\n\t    dblclick = obj[_pre + 'dblclick' + id];\r\n\r\n\tobj.removeEventListener(_touchstart, touchstart, false);\r\n\tobj.removeEventListener(_touchend, touchend, false);\r\n\tif (!Browser.edge) {\r\n\t\tobj.removeEventListener('dblclick', dblclick, false);\r\n\t}\r\n\r\n\treturn this;\r\n}\r\n","import {Point} from '../geometry/Point';\r\nimport * as Util from '../core/Util';\r\nimport * as Browser from '../core/Browser';\r\nimport {addPointerListener, removePointerListener} from './DomEvent.Pointer';\r\nimport {addDoubleTapListener, removeDoubleTapListener} from './DomEvent.DoubleTap';\r\n\r\n/*\r\n * @namespace DomEvent\r\n * Utility functions to work with the [DOM events](https://developer.mozilla.org/docs/Web/API/Event), used by Leaflet internally.\r\n */\r\n\r\n// Inspired by John Resig, Dean Edwards and YUI addEvent implementations.\r\n\r\n// @function on(el: HTMLElement, types: String, fn: Function, context?: Object): this\r\n// Adds a listener function (`fn`) to a particular DOM event type of the\r\n// element `el`. You can optionally specify the context of the listener\r\n// (object the `this` keyword will point to). You can also pass several\r\n// space-separated types (e.g. `'click dblclick'`).\r\n\r\n// @alternative\r\n// @function on(el: HTMLElement, eventMap: Object, context?: Object): this\r\n// Adds a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`\r\nexport function on(obj, types, fn, context) {\r\n\r\n\tif (typeof types === 'object') {\r\n\t\tfor (var type in types) {\r\n\t\t\taddOne(obj, type, types[type], fn);\r\n\t\t}\r\n\t} else {\r\n\t\ttypes = Util.splitWords(types);\r\n\r\n\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\taddOne(obj, types[i], fn, context);\r\n\t\t}\r\n\t}\r\n\r\n\treturn this;\r\n}\r\n\r\nvar eventsKey = '_leaflet_events';\r\n\r\n// @function off(el: HTMLElement, types: String, fn: Function, context?: Object): this\r\n// Removes a previously added listener function. If no function is specified,\r\n// it will remove all the listeners of that particular DOM event from the element.\r\n// Note that if you passed a custom context to on, you must pass the same\r\n// context to `off` in order to remove the listener.\r\n\r\n// @alternative\r\n// @function off(el: HTMLElement, eventMap: Object, context?: Object): this\r\n// Removes a set of type/listener pairs, e.g. `{click: onClick, mousemove: onMouseMove}`\r\n\r\n// @alternative\r\n// @function off(el: HTMLElement): this\r\n// Removes all known event listeners\r\nexport function off(obj, types, fn, context) {\r\n\r\n\tif (typeof types === 'object') {\r\n\t\tfor (var type in types) {\r\n\t\t\tremoveOne(obj, type, types[type], fn);\r\n\t\t}\r\n\t} else if (types) {\r\n\t\ttypes = Util.splitWords(types);\r\n\r\n\t\tfor (var i = 0, len = types.length; i < len; i++) {\r\n\t\t\tremoveOne(obj, types[i], fn, context);\r\n\t\t}\r\n\t} else {\r\n\t\tfor (var j in obj[eventsKey]) {\r\n\t\t\tremoveOne(obj, j, obj[eventsKey][j]);\r\n\t\t}\r\n\t\tdelete obj[eventsKey];\r\n\t}\r\n}\r\n\r\nfunction addOne(obj, type, fn, context) {\r\n\tvar id = type + Util.stamp(fn) + (context ? '_' + Util.stamp(context) : '');\r\n\r\n\tif (obj[eventsKey] && obj[eventsKey][id]) { return this; }\r\n\r\n\tvar handler = function (e) {\r\n\t\treturn fn.call(context || obj, e || window.event);\r\n\t};\r\n\r\n\tvar originalHandler = handler;\r\n\r\n\tif (Browser.pointer && type.indexOf('touch') === 0) {\r\n\t\t// Needs DomEvent.Pointer.js\r\n\t\taddPointerListener(obj, type, handler, id);\r\n\r\n\t} else if (Browser.touch && (type === 'dblclick') && addDoubleTapListener &&\r\n\t           !(Browser.pointer && Browser.chrome)) {\r\n\t\t// Chrome >55 does not need the synthetic dblclicks from addDoubleTapListener\r\n\t\t// See #5180\r\n\t\taddDoubleTapListener(obj, handler, id);\r\n\r\n\t} else if ('addEventListener' in obj) {\r\n\r\n\t\tif (type === 'mousewheel') {\r\n\t\t\tobj.addEventListener('onwheel' in obj ? 'wheel' : 'mousewheel', handler, false);\r\n\r\n\t\t} else if ((type === 'mouseenter') || (type === 'mouseleave')) {\r\n\t\t\thandler = function (e) {\r\n\t\t\t\te = e || window.event;\r\n\t\t\t\tif (isExternalTarget(obj, e)) {\r\n\t\t\t\t\toriginalHandler(e);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tobj.addEventListener(type === 'mouseenter' ? 'mouseover' : 'mouseout', handler, false);\r\n\r\n\t\t} else {\r\n\t\t\tif (type === 'click' && Browser.android) {\r\n\t\t\t\thandler = function (e) {\r\n\t\t\t\t\tfilterClick(e, originalHandler);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tobj.addEventListener(type, handler, false);\r\n\t\t}\r\n\r\n\t} else if ('attachEvent' in obj) {\r\n\t\tobj.attachEvent('on' + type, handler);\r\n\t}\r\n\r\n\tobj[eventsKey] = obj[eventsKey] || {};\r\n\tobj[eventsKey][id] = handler;\r\n}\r\n\r\nfunction removeOne(obj, type, fn, context) {\r\n\r\n\tvar id = type + Util.stamp(fn) + (context ? '_' + Util.stamp(context) : ''),\r\n\t    handler = obj[eventsKey] && obj[eventsKey][id];\r\n\r\n\tif (!handler) { return this; }\r\n\r\n\tif (Browser.pointer && type.indexOf('touch') === 0) {\r\n\t\tremovePointerListener(obj, type, id);\r\n\r\n\t} else if (Browser.touch && (type === 'dblclick') && removeDoubleTapListener) {\r\n\t\tremoveDoubleTapListener(obj, id);\r\n\r\n\t} else if ('removeEventListener' in obj) {\r\n\r\n\t\tif (type === 'mousewheel') {\r\n\t\t\tobj.removeEventListener('onwheel' in obj ? 'wheel' : 'mousewheel', handler, false);\r\n\r\n\t\t} else {\r\n\t\t\tobj.removeEventListener(\r\n\t\t\t\ttype === 'mouseenter' ? 'mouseover' :\r\n\t\t\t\ttype === 'mouseleave' ? 'mouseout' : type, handler, false);\r\n\t\t}\r\n\r\n\t} else if ('detachEvent' in obj) {\r\n\t\tobj.detachEvent('on' + type, handler);\r\n\t}\r\n\r\n\tobj[eventsKey][id] = null;\r\n}\r\n\r\n// @function stopPropagation(ev: DOMEvent): this\r\n// Stop the given event from propagation to parent elements. Used inside the listener functions:\r\n// ```js\r\n// L.DomEvent.on(div, 'click', function (ev) {\r\n// \tL.DomEvent.stopPropagation(ev);\r\n// });\r\n// ```\r\nexport function stopPropagation(e) {\r\n\r\n\tif (e.stopPropagation) {\r\n\t\te.stopPropagation();\r\n\t} else if (e.originalEvent) {  // In case of Leaflet event.\r\n\t\te.originalEvent._stopped = true;\r\n\t} else {\r\n\t\te.cancelBubble = true;\r\n\t}\r\n\tskipped(e);\r\n\r\n\treturn this;\r\n}\r\n\r\n// @function disableScrollPropagation(el: HTMLElement): this\r\n// Adds `stopPropagation` to the element's `'mousewheel'` events (plus browser variants).\r\nexport function disableScrollPropagation(el) {\r\n\treturn addOne(el, 'mousewheel', stopPropagation);\r\n}\r\n\r\n// @function disableClickPropagation(el: HTMLElement): this\r\n// Adds `stopPropagation` to the element's `'click'`, `'doubleclick'`,\r\n// `'mousedown'` and `'touchstart'` events (plus browser variants).\r\nexport function disableClickPropagation(el) {\r\n\ton(el, 'mousedown touchstart dblclick', stopPropagation);\r\n\taddOne(el, 'click', fakeStop);\r\n\treturn this;\r\n}\r\n\r\n// @function preventDefault(ev: DOMEvent): this\r\n// Prevents the default action of the DOM Event `ev` from happening (such as\r\n// following a link in the href of the a element, or doing a POST request\r\n// with page reload when a `<form>` is submitted).\r\n// Use it inside listener functions.\r\nexport function preventDefault(e) {\r\n\tif (e.preventDefault) {\r\n\t\te.preventDefault();\r\n\t} else {\r\n\t\te.returnValue = false;\r\n\t}\r\n\treturn this;\r\n}\r\n\r\n// @function stop(ev): this\r\n// Does `stopPropagation` and `preventDefault` at the same time.\r\nexport function stop(e) {\r\n\tpreventDefault(e);\r\n\tstopPropagation(e);\r\n\treturn this;\r\n}\r\n\r\n// @function getMousePosition(ev: DOMEvent, container?: HTMLElement): Point\r\n// Gets normalized mouse position from a DOM event relative to the\r\n// `container` or to the whole page if not specified.\r\nexport function getMousePosition(e, container) {\r\n\tif (!container) {\r\n\t\treturn new Point(e.clientX, e.clientY);\r\n\t}\r\n\r\n\tvar rect = container.getBoundingClientRect();\r\n\r\n\treturn new Point(\r\n\t\te.clientX - rect.left - container.clientLeft,\r\n\t\te.clientY - rect.top - container.clientTop);\r\n}\r\n\r\n// Chrome on Win scrolls double the pixels as in other platforms (see #4538),\r\n// and Firefox scrolls device pixels, not CSS pixels\r\nvar wheelPxFactor =\r\n\t(Browser.win && Browser.chrome) ? 2 :\r\n\tBrowser.gecko ? window.devicePixelRatio : 1;\r\n\r\n// @function getWheelDelta(ev: DOMEvent): Number\r\n// Gets normalized wheel delta from a mousewheel DOM event, in vertical\r\n// pixels scrolled (negative if scrolling down).\r\n// Events from pointing devices without precise scrolling are mapped to\r\n// a best guess of 60 pixels.\r\nexport function getWheelDelta(e) {\r\n\treturn (Browser.edge) ? e.wheelDeltaY / 2 : // Don't trust window-geometry-based delta\r\n\t       (e.deltaY && e.deltaMode === 0) ? -e.deltaY / wheelPxFactor : // Pixels\r\n\t       (e.deltaY && e.deltaMode === 1) ? -e.deltaY * 20 : // Lines\r\n\t       (e.deltaY && e.deltaMode === 2) ? -e.deltaY * 60 : // Pages\r\n\t       (e.deltaX || e.deltaZ) ? 0 :\t// Skip horizontal/depth wheel events\r\n\t       e.wheelDelta ? (e.wheelDeltaY || e.wheelDelta) / 2 : // Legacy IE pixels\r\n\t       (e.detail && Math.abs(e.detail) < 32765) ? -e.detail * 20 : // Legacy Moz lines\r\n\t       e.detail ? e.detail / -32765 * 60 : // Legacy Moz pages\r\n\t       0;\r\n}\r\n\r\nvar skipEvents = {};\r\n\r\nexport function fakeStop(e) {\r\n\t// fakes stopPropagation by setting a special event flag, checked/reset with skipped(e)\r\n\tskipEvents[e.type] = true;\r\n}\r\n\r\nexport function skipped(e) {\r\n\tvar events = skipEvents[e.type];\r\n\t// reset when checking, as it's only used in map container and propagates outside of the map\r\n\tskipEvents[e.type] = false;\r\n\treturn events;\r\n}\r\n\r\n// check if element really left/entered the event target (for mouseenter/mouseleave)\r\nexport function isExternalTarget(el, e) {\r\n\r\n\tvar related = e.relatedTarget;\r\n\r\n\tif (!related) { return true; }\r\n\r\n\ttry {\r\n\t\twhile (related && (related !== el)) {\r\n\t\t\trelated = related.parentNode;\r\n\t\t}\r\n\t} catch (err) {\r\n\t\treturn false;\r\n\t}\r\n\treturn (related !== el);\r\n}\r\n\r\nvar lastClick;\r\n\r\n// this is a horrible workaround for a bug in Android where a single touch triggers two click events\r\nfunction filterClick(e, handler) {\r\n\tvar timeStamp = (e.timeStamp || (e.originalEvent && e.originalEvent.timeStamp)),\r\n\t    elapsed = lastClick && (timeStamp - lastClick);\r\n\r\n\t// are they closer together than 500ms yet more than 100ms?\r\n\t// Android typically triggers them ~300ms apart while multiple listeners\r\n\t// on the same event should be triggered far faster;\r\n\t// or check if click is simulated on the element, and if it is, reject any non-simulated events\r\n\r\n\tif ((elapsed && elapsed > 100 && elapsed < 500) || (e.target._simulatedClick && !e._simulated)) {\r\n\t\tstop(e);\r\n\t\treturn;\r\n\t}\r\n\tlastClick = timeStamp;\r\n\r\n\thandler(e);\r\n}\r\n\r\n// @function addListener(…): this\r\n// Alias to [`L.DomEvent.on`](#domevent-on)\r\nexport {on as addListener};\r\n\r\n// @function removeListener(…): this\r\n// Alias to [`L.DomEvent.off`](#domevent-off)\r\nexport {off as removeListener};\r\n","import * as DomEvent from './DomEvent';\nimport * as Util from '../core/Util';\nimport {Point} from '../geometry/Point';\nimport * as Browser from '../core/Browser';\n\n/*\n * @namespace DomUtil\n *\n * Utility functions to work with the [DOM](https://developer.mozilla.org/docs/Web/API/Document_Object_Model)\n * tree, used by Leaflet internally.\n *\n * Most functions expecting or returning a `HTMLElement` also work for\n * SVG elements. The only difference is that classes refer to CSS classes\n * in HTML and SVG classes in SVG.\n */\n\n if (!Element.prototype.matches) {\n    var ep = Element.prototype;\n \n    if (ep.webkitMatchesSelector) // Chrome <34, SF<7.1, iOS<8\n      ep.matches = ep.webkitMatchesSelector;\n \n    if (ep.msMatchesSelector) // IE9/10/11 & Edge\n      ep.matches = ep.msMatchesSelector;\n \n    if (ep.mozMatchesSelector) // FF<34\n      ep.matches = ep.mozMatchesSelector;\n }\n\n// @property TRANSFORM: String\n// Vendor-prefixed fransform style name (e.g. `'webkitTransform'` for WebKit).\nexport var TRANSFORM = testProp(\n    ['transform', 'WebkitTransform', 'OTransform', 'MozTransform', 'msTransform']);\n\n// webkitTransition comes first because some browser versions that drop vendor prefix don't do\n// the same for the transitionend event, in particular the Android 4.1 stock browser\n\n// @property TRANSITION: String\n// Vendor-prefixed transform style name.\nexport var TRANSITION = testProp(\n    ['webkitTransition', 'transition', 'OTransition', 'MozTransition', 'msTransition']);\n\nexport var TRANSITION_END =\n    TRANSITION === 'webkitTransition' || TRANSITION === 'OTransition' ? TRANSITION + 'End' : 'transitionend';\n\n\n// @function get(id: String|HTMLElement): HTMLElement\n// Returns an element given its DOM id, or returns the element itself\n// if it was passed directly.\nexport function get(id) {\n    return typeof id === 'string' ? document.getElementById(id) : id;\n}\n\n// @function getStyle(el: HTMLElement, styleAttrib: String): String\n// Returns the value for a certain style attribute on an element,\n// including computed values or values set through CSS.\nexport function getStyle(el, style) {\n    var value = el.style[style] || (el.currentStyle && el.currentStyle[style]);\n\n    if ((!value || value === 'auto') && document.defaultView) {\n        var css = document.defaultView.getComputedStyle(el, null);\n        value = css ? css[style] : null;\n    }\n    return value === 'auto' ? null : value;\n}\n\n// @function create(tagName: String, className?: String, container?: HTMLElement): HTMLElement\n// Creates an HTML element with `tagName`, sets its class to `className`, and optionally appends it to `container` element.\nexport function create(tagName, className, container) {\n    var el = document.createElement(tagName);\n    el.className = className || '';\n\n    if (container) {\n        container.appendChild(el);\n    }\n    return el;\n}\n\n// @function remove(el: HTMLElement)\n// Removes `el` from its parent element\nexport function remove(el) {\n    var parent = el.parentNode;\n    if (parent) {\n        parent.removeChild(el);\n    }\n}\n\n// @function empty(el: HTMLElement)\n// Removes all of `el`'s children elements from `el`\nexport function empty(el) {\n    while (el.firstChild) {\n        el.removeChild(el.firstChild);\n    }\n}\n\n// @function toFront(el: HTMLElement)\n// Makes `el` the last child of its parent, so it renders in front of the other children.\nexport function toFront(el) {\n    el.parentNode.appendChild(el);\n}\n\n// @function toBack(el: HTMLElement)\n// Makes `el` the first child of its parent, so it renders behind the other children.\nexport function toBack(el) {\n    var parent = el.parentNode;\n    parent.insertBefore(el, parent.firstChild);\n}\n\n// @function hasClass(el: HTMLElement, name: String): Boolean\n// Returns `true` if the element's class attribute contains `name`.\nexport function hasClass(el, name) {\n    if (el.classList !== undefined) {\n        return el.classList.contains(name);\n    }\n    var className = getClass(el);\n    return className.length > 0 && new RegExp('(^|\\\\s)' + name + '(\\\\s|$)').test(className);\n}\n\n// @function addClass(el: HTMLElement, name: String)\n// Adds `name` to the element's class attribute.\nexport function addClass(el, name) {\n    if (el.classList !== undefined) {\n        var classes = Util.splitWords(name);\n        for (var i = 0, len = classes.length; i < len; i++) {\n            el.classList.add(classes[i]);\n        }\n    } else if (!hasClass(el, name)) {\n        var className = getClass(el);\n        setClass(el, (className ? className + ' ' : '') + name);\n    }\n}\n\n// @function removeClass(el: HTMLElement, name: String)\n// Removes `name` from the element's class attribute.\nexport function removeClass(el, name) {\n    if (el.classList !== undefined) {\n        el.classList.remove(name);\n    } else {\n        setClass(el, Util.trim((' ' + getClass(el) + ' ').replace(' ' + name + ' ', ' ')));\n    }\n}\n\n// @function setClass(el: HTMLElement, name: String)\n// Sets the element's class.\nexport function setClass(el, name) {\n    if (el.className.baseVal === undefined) {\n        el.className = name;\n    } else {\n        // in case of SVG element\n        el.className.baseVal = name;\n    }\n}\n\n// @function getClass(el: HTMLElement): String\n// Returns the element's class.\nexport function getClass(el) {\n    return el.className.baseVal === undefined ? el.className : el.className.baseVal;\n}\n\n// @function setOpacity(el: HTMLElement, opacity: Number)\n// Set the opacity of an element (including old IE support).\n// `opacity` must be a number from `0` to `1`.\nexport function setOpacity(el, value) {\n    if ('opacity' in el.style) {\n        el.style.opacity = value;\n    } else if ('filter' in el.style) {\n        _setOpacityIE(el, value);\n    }\n}\n\nfunction _setOpacityIE(el, value) {\n    var filter = false,\n        filterName = 'DXImageTransform.Microsoft.Alpha';\n\n    // filters collection throws an error if we try to retrieve a filter that doesn't exist\n    try {\n        filter = el.filters.item(filterName);\n    } catch (e) {\n        // don't set opacity to 1 if we haven't already set an opacity,\n        // it isn't needed and breaks transparent pngs.\n        if (value === 1) { return; }\n    }\n\n    value = Math.round(value * 100);\n\n    if (filter) {\n        filter.Enabled = (value !== 100);\n        filter.Opacity = value;\n    } else {\n        el.style.filter += ' progid:' + filterName + '(opacity=' + value + ')';\n    }\n}\n\n// @function testProp(props: String[]): String|false\n// Goes through the array of style names and returns the first name\n// that is a valid style name for an element. If no such name is found,\n// it returns false. Useful for vendor-prefixed styles like `transform`.\nexport function testProp(props) {\n    var style = document.documentElement.style;\n\n    for (var i = 0; i < props.length; i++) {\n        if (props[i] in style) {\n            return props[i];\n        }\n    }\n    return false;\n}\n\nexport function isPropertySupported(prop) {\n    var style = document.documentElement.style;\n    return prop in style;\n}\n\n// @function setTransform(el: HTMLElement, offset: Point, scale?: Number)\n// Resets the 3D CSS transform of `el` so it is translated by `offset` pixels\n// and optionally scaled by `scale`. Does not have an effect if the\n// browser doesn't support 3D CSS transforms.\nexport function setTransform(el, offset, scale) {\n    var pos = offset || new Point(0, 0);\n\n    el.style[TRANSFORM] =\n        (Browser.ie3d ?\n            'translate(' + pos.x + 'px,' + pos.y + 'px)' :\n            'translate3d(' + pos.x + 'px,' + pos.y + 'px,0)') +\n        (scale ? ' scale(' + scale + ')' : '');\n}\n\n// @function setPosition(el: HTMLElement, position: Point)\n// Sets the position of `el` to coordinates specified by `position`,\n// using CSS translate or top/left positioning depending on the browser\n// (used by Leaflet internally to position its layers).\nexport function setPosition(el, point) {\n\n    /*eslint-disable */\n    el._leaflet_pos = point;\n    /*eslint-enable */\n\n    if (Browser.any3d) {\n        setTransform(el, point);\n    } else {\n        el.style.left = point.x + 'px';\n        el.style.top = point.y + 'px';\n    }\n}\n\n// @function getPosition(el: HTMLElement): Point\n// Returns the coordinates of an element previously positioned with setPosition.\nexport function getPosition(el) {\n    // this method is only used for elements previously positioned using setPosition,\n    // so it's safe to cache the position for performance\n\n    return el._leaflet_pos || new Point(0, 0);\n}\n\n// @function disableTextSelection()\n// Prevents the user from generating `selectstart` DOM events, usually generated\n// when the user drags the mouse through a page with text. Used internally\n// by Leaflet to override the behaviour of any click-and-drag interaction on\n// the map. Affects drag interactions on the whole document.\n\n// @function enableTextSelection()\n// Cancels the effects of a previous [`L.DomUtil.disableTextSelection`](#domutil-disabletextselection).\nexport var disableTextSelection;\nexport var enableTextSelection;\nvar _userSelect;\nif ('onselectstart' in document) {\n    disableTextSelection = function () {\n        DomEvent.on(window, 'selectstart', DomEvent.preventDefault);\n    };\n    enableTextSelection = function () {\n        DomEvent.off(window, 'selectstart', DomEvent.preventDefault);\n    };\n} else {\n    var userSelectProperty = testProp(\n        ['userSelect', 'WebkitUserSelect', 'OUserSelect', 'MozUserSelect', 'msUserSelect']);\n\n    disableTextSelection = function () {\n        if (userSelectProperty) {\n            var style = document.documentElement.style;\n            _userSelect = style[userSelectProperty];\n            style[userSelectProperty] = 'none';\n        }\n    };\n    enableTextSelection = function () {\n        if (userSelectProperty) {\n            document.documentElement.style[userSelectProperty] = _userSelect;\n            _userSelect = undefined;\n        }\n    };\n}\n\n// @function disableImageDrag()\n// As [`L.DomUtil.disableTextSelection`](#domutil-disabletextselection), but\n// for `dragstart` DOM events, usually generated when the user drags an image.\nexport function disableImageDrag() {\n    DomEvent.on(window, 'dragstart', DomEvent.preventDefault);\n}\n\n// @function enableImageDrag()\n// Cancels the effects of a previous [`L.DomUtil.disableImageDrag`](#domutil-disabletextselection).\nexport function enableImageDrag() {\n    DomEvent.off(window, 'dragstart', DomEvent.preventDefault);\n}\n\nvar _outlineElement, _outlineStyle;\n// @function preventOutline(el: HTMLElement)\n// Makes the [outline](https://developer.mozilla.org/docs/Web/CSS/outline)\n// of the element `el` invisible. Used internally by Leaflet to prevent\n// focusable elements from displaying an outline when the user performs a\n// drag interaction on them.\nexport function preventOutline(element) {\n    while (element.tabIndex === -1) {\n        element = element.parentNode;\n    }\n    if (!element || !element.style) { return; }\n    restoreOutline();\n    _outlineElement = element;\n    _outlineStyle = element.style.outline;\n    element.style.outline = 'none';\n    DomEvent.on(window, 'keydown', restoreOutline);\n}\n\n// @function restoreOutline()\n// Cancels the effects of a previous [`L.DomUtil.preventOutline`]().\nexport function restoreOutline() {\n    if (!_outlineElement) { return; }\n    _outlineElement.style.outline = _outlineStyle;\n    _outlineElement = undefined;\n    _outlineStyle = undefined;\n    DomEvent.off(window, 'keydown', restoreOutline);\n}\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var document = typeof window !== 'undefined' && typeof window.document !== 'undefined' ? window.document : {};\nvar keyboardAllowed = typeof Element !== 'undefined' && 'ALLOW_KEYBOARD_INPUT' in Element;\n\nvar fn = (function () {\n  var val;\n\n  var fnMap = [\n    [\n      'requestFullscreen',\n      'exitFullscreen',\n      'fullscreenElement',\n      'fullscreenEnabled',\n      'fullscreenchange',\n      'fullscreenerror'\n    ],\n    // New WebKit\n    [\n      'webkitRequestFullscreen',\n      'webkitExitFullscreen',\n      'webkitFullscreenElement',\n      'webkitFullscreenEnabled',\n      'webkitfullscreenchange',\n      'webkitfullscreenerror'\n\n    ],\n    // Old WebKit (Safari 5.1)\n    [\n      'webkitRequestFullScreen',\n      'webkitCancelFullScreen',\n      'webkitCurrentFullScreenElement',\n      'webkitCancelFullScreen',\n      'webkitfullscreenchange',\n      'webkitfullscreenerror'\n\n    ],\n    [\n      'mozRequestFullScreen',\n      'mozCancelFullScreen',\n      'mozFullScreenElement',\n      'mozFullScreenEnabled',\n      'mozfullscreenchange',\n      'mozfullscreenerror'\n    ],\n    [\n      'msRequestFullscreen',\n      'msExitFullscreen',\n      'msFullscreenElement',\n      'msFullscreenEnabled',\n      'MSFullscreenChange',\n      'MSFullscreenError'\n    ]\n  ];\n\n  var i = 0;\n  var l = fnMap.length;\n  var ret = {};\n\n  for (; i < l; i++) {\n    val = fnMap[i];\n    if (val && val[1] in document) {\n      for (i = 0; i < val.length; i++) {\n        ret[fnMap[0][i]] = val[i];\n      }\n      return ret;\n    }\n  }\n\n  return false;\n})();\n\nvar eventNameMap = {\n  change: fn.fullscreenchange,\n  error: fn.fullscreenerror\n};\n\nvar screenfull = {\n  request: function (elem) {\n    var request = fn.requestFullscreen;\n\n    elem = elem || document.documentElement;\n\n    // Work around Safari 5.1 bug: reports support for\n    // keyboard in fullscreen even though it doesn't.\n    // Browser sniffing, since the alternative with\n    // setTimeout is even worse.\n    if (/5\\.1[.\\d]* Safari/.test(navigator.userAgent)) {\n      elem[request]();\n    } else {\n      elem[request](keyboardAllowed && Element.ALLOW_KEYBOARD_INPUT);\n    }\n  },\n  exit: function () {\n    document[fn.exitFullscreen]();\n  },\n  toggle: function (elem) {\n    if (this.isFullscreen) {\n      this.exit();\n    } else {\n      this.request(elem);\n    }\n  },\n  onchange: function (callback) {\n    this.on('change', callback);\n  },\n  onerror: function (callback) {\n    this.on('error', callback);\n  },\n  on: function (event, callback) {\n    var eventName = eventNameMap[event];\n    if (eventName) {\n      document.addEventListener(eventName, callback, false);\n    }\n  },\n  off: function (event, callback) {\n    var eventName = eventNameMap[event];\n    if (eventName) {\n      document.removeEventListener(eventName, callback, false);\n    }\n  },\n  raw: fn\n};\n\nObject.defineProperties(screenfull, {\n  isFullscreen: {\n    get: function () {\n      return Boolean(document[fn.fullscreenElement]);\n    }\n  },\n  element: {\n    enumerable: true,\n    get: function () {\n      return document[fn.fullscreenElement];\n    }\n  },\n  enabled: {\n    enumerable: true,\n    get: function () {\n      // Coerce to boolean in case of old WebKit\n      return Boolean(document[fn.fullscreenEnabled]);\n    }\n  }\n});\n\nexport {screenfull};","import * as Util from '../core/Util';\nimport {Evented} from '../core/Events';\n// import {Class} from '../core/Class';\nimport * as Browser from '../core/Browser';\nimport * as DomEvent from '../dom/DomEvent';\nimport * as DomUtil from '../dom/DomUtil';\n\nimport debounce from 'lodash/debounce';\n\nimport {screenfull} from '../screenfull';\n\n/*\n * @class Reader\n * @aka cozy.Map\n * @inherits Evented\n *\n * The central class of the API — it is used to create a book on a page and manipulate it.\n *\n * @example\n *\n * ```js\n * // initialize the map on the \"map\" div with a given center and zoom\n * var map = L.map('map', {\n *  center: [51.505, -0.09],\n *  zoom: 13\n * });\n * ```\n *\n */\n\nvar _padding = 1.0;\nexport var Reader = Evented.extend({\n  options: {\n    regions: [\n      'header',\n      'toolbar.top',\n      'toolbar.left',\n      'main',\n      'toolbar.right',\n      'toolbar.bottom',\n      'footer'\n    ],\n    metadata: {},\n    flow: 'auto',\n    engine: 'epubjs',\n    fontSizeLarge: '140%',\n    fontSizeSmall: '90%',\n    fontSizeDefault: '100%',\n    trackResize: true,\n    mobileMediaQuery: '(min-device-width : 300px) and (max-device-width : 600px)',\n    theme: 'default',\n    themes: []\n  },\n\n  initialize: function(id, options) {\n    var self = this\n\n    options = Util.setOptions(this, options);\n    this._checkFeatureCompatibility();\n\n    this.metadata = this.options.metadata; // initial seed\n\n    this._initContainer(id);\n    this._initLayout();\n\n    if ( this.options.themes && this.options.themes.length > 0 ) {\n        this.options.themes.forEach(function(theme) {\n            if ( theme.href ) { return; }\n            var klass = theme.klass;\n            var rules = {};\n            for(var rule in theme.rules) {\n                var new_rule = '.' + klass;\n                if ( rule == 'body' ) { new_rule = 'body' + new_rule; }\n                else { new_rule += ' ' + rule ; }\n                rules[new_rule] = theme.rules[rule];\n            }\n            theme.rules = rules;\n        });\n    }\n\n    this._updateTheme();\n\n    // hack for https://github.com/Leaflet/Leaflet/issues/1980\n    // this._onResize = Util.bind(this._onResize, this);\n\n    this._initEvents();\n\n    this.callInitHooks();\n\n    this._mode = this.options.mode;\n  },\n\n  start: function(target, cb) {\n    var self = this;\n\n    if ( typeof(target) == 'function' && cb === undefined ) {\n      cb = target;\n      target = undefined;\n    }\n\n    Util.loader.js(this.options.engine_href).then(function() {\n      self._start(target, cb);\n      self._loaded = true;\n    })\n  },\n\n  _start: function(target, cb) {\n    var self = this;\n    target = target || 0;\n\n    self.open(function() {\n      self.draw(target, cb);\n    });\n  },\n\n  switch: function(flow, target) {\n    var target = target || this.currentLocation();\n    if ( flow === undefined ) {\n      flow = ( this.options.flow == 'auto' ) ? 'scrolled-doc' : 'auto';\n    }\n    this.options.flow = flow;\n    this.destroy();\n    this.draw(target);\n  },\n\n  reopen: function(options, target) {\n    var target = target || this.currentLocation();\n    Util.extend(this.options, options);\n    this.destroy();\n    console.log(\"AHOY REOPENED?\");\n    return;\n    this.draw(target);\n    this.fire('reopen');\n  },\n\n  _updateTheme: function() {\n    DomUtil.removeClass(this._container, 'cozy-theme-' + ( this._container.dataset.theme || 'default' ));\n    DomUtil.addClass(this._container, 'cozy-theme-' + this.options.theme);\n    this._container.dataset.theme = this.options.theme;\n  },\n\n  draw: function(target) {\n    // NOOP\n  },\n\n  next: function() {\n    // NOOP\n  },\n\n  prev: function() {\n    // NOOP\n  },\n\n  display: function(index) {\n    // NOOP\n  },\n\n  gotoPage: function(target) {\n    // NOOP\n  },\n\n  goBack: function() {\n    history.back();\n  },\n\n  goForward: function() {\n    history.forward();\n  },\n\n  requestFullscreen: function() {\n    if ( screenfull.enabled ) {\n      // this._preResize();\n      screenfull.toggle(this._container);\n    }\n  },\n\n  _preResize: function() {\n\n  },\n\n  _initContainer: function (id) {\n    var container = this._container = DomUtil.get(id);\n\n    if (!container) {\n      throw new Error('Reader container not found.');\n    } else if (container._cozy_id) {\n      throw new Error('Reader container is already initialized.');\n    }\n\n    DomEvent.on(container, 'scroll', this._onScroll, this);\n    this._containerId = Util.stamp(container);\n  },\n\n  _initLayout: function () {\n    var container = this._container;\n\n    this._fadeAnimated = this.options.fadeAnimation && Browser.any3d;\n\n    DomUtil.addClass(container, 'cozy-container' +\n      (Browser.touch ? ' cozy-touch' : '') +\n      (Browser.retina ? ' cozy-retina' : '') +\n      (Browser.ielt9 ? ' cozy-oldie' : '') +\n      (Browser.safari ? ' cozy-safari' : '') +\n      (this._fadeAnimated ? ' cozy-fade-anim' : '') +\n      ' cozy-engine-' + this.options.engine + \n      ' cozy-theme-' + this.options.theme);\n\n    var position = DomUtil.getStyle(container, 'position');\n\n    this._initPanes();\n\n    if ( ! Browser.columnCount ) {\n      this.options.flow = 'scrolled-doc';\n    }\n  },\n\n  _initPanes: function () {\n    var self = this;\n\n    var panes = this._panes = {};\n\n    var l = 'cozy-';\n    var container = this._container;\n\n    var prefix = 'cozy-module-';\n\n    DomUtil.addClass(container, 'cozy-container');\n    panes['top'] = DomUtil.create('div', prefix + 'top', container);\n    panes['main'] = DomUtil.create('div', prefix + 'main', container);\n    panes['bottom'] = DomUtil.create('div', prefix + 'bottom', container);\n\n    panes['left'] = DomUtil.create('div', prefix + 'left', panes['main']);\n    panes['book-cover'] = DomUtil.create('div', prefix + 'book-cover', panes['main']);\n    panes['right'] = DomUtil.create('div', prefix + 'right', panes['main']);\n    panes['book'] = DomUtil.create('div', prefix + 'book', panes['book-cover']);\n    panes['loader'] = DomUtil.create('div', prefix + 'book-loading', panes['book']);\n    this._initLoader();\n  },\n\n  _checkIfLoaded: function () {\n    if (!this._loaded) {\n      throw new Error('Set map center and zoom first.');\n    }\n  },\n\n  // DOM event handling\n\n  // @section Interaction events\n  _initEvents: function (remove) {\n    this._targets = {};\n    this._targets[Util.stamp(this._container)] = this;\n\n    var onOff = remove ? DomEvent.off : DomEvent.on;\n\n    // @event click: MouseEvent\n    // Fired when the user clicks (or taps) the map.\n    // @event dblclick: MouseEvent\n    // Fired when the user double-clicks (or double-taps) the map.\n    // @event mousedown: MouseEvent\n    // Fired when the user pushes the mouse button on the map.\n    // @event mouseup: MouseEvent\n    // Fired when the user releases the mouse button on the map.\n    // @event mouseover: MouseEvent\n    // Fired when the mouse enters the map.\n    // @event mouseout: MouseEvent\n    // Fired when the mouse leaves the map.\n    // @event mousemove: MouseEvent\n    // Fired while the mouse moves over the map.\n    // @event contextmenu: MouseEvent\n    // Fired when the user pushes the right mouse button on the map, prevents\n    // default browser context menu from showing if there are listeners on\n    // this event. Also fired on mobile when the user holds a single touch\n    // for a second (also called long press).\n    // @event keypress: KeyboardEvent\n    // Fired when the user presses a key from the keyboard while the map is focused.\n    // onOff(this._container, 'click dblclick mousedown mouseup ' +\n    //   'mouseover mouseout mousemove contextmenu keypress', this._handleDOMEvent, this);\n\n    // if (this.options.trackResize) {\n    //   var self = this;\n    //   var fn = debounce(function(){ self.invalidateSize({}); }, 150);\n    //   onOff(window, 'resize', fn, this);\n    // }\n\n    if (Browser.any3d && this.options.transform3DLimit) {\n      (remove ? this.off : this.on).call(this, 'moveend', this._onMoveEnd);\n    }\n\n    var self = this;\n    if (screenfull.enabled) {\n      screenfull.on('change', function() {\n        // setTimeout(function() {\n        //   self.invalidateSize({});\n        // }, 100);\n        console.log('AHOY: Am I fullscreen?', screenfull.isFullscreen ? 'YES' : 'NO');\n      });\n    }\n\n    self.on(\"updateLocation\", function(location) {\n      var location_href = location.start;\n\n      if ( self._ignoreHistory ) {\n        self._ignoreHistory = false;\n      } else {\n        var tmp_href = window.location.href.split(\"#\");\n        tmp_href[1] = location_href.substr(8, location_href.length - 8 - 1);\n        history.pushState({ cfi: location_href }, '', tmp_href.join('#'));\n      }\n\n      // window.location.hash = '#' + location_href.substr(8, location_href.length - 8 - 1);\n    })\n\n    window.addEventListener('popstate', function(event) {\n      if ( event.isTrusted && event.state !== null ) {\n        self._ignoreHistory = true;\n        self.gotoPage(event.state.cfi);\n      }\n    })\n  },\n\n  // _onResize: function() {\n  //   if ( ! this._resizeRequest ) {\n  //     this._resizeRequest = Util.requestAnimFrame(function() {\n  //       this.invalidateSize({})\n  //     }, this);\n  //   }\n  // },\n\n  _onScroll: function () {\n    this._container.scrollTop  = 0;\n    this._container.scrollLeft = 0;\n  },\n\n  _handleDOMEvent: function (e) {\n    if (!this._loaded || DomEvent.skipped(e)) { return; }\n\n    var type = e.type === 'keypress' && e.keyCode === 13 ? 'click' : e.type;\n\n    if (type === 'mousedown') {\n      // prevents outline when clicking on keyboard-focusable element\n      DomUtil.preventOutline(e.target || e.srcElement);\n    }\n\n    this._fireDOMEvent(e, type);\n  },\n\n  _fireDOMEvent: function (e, type, targets) {\n\n    if (e.type === 'click') {\n      // Fire a synthetic 'preclick' event which propagates up (mainly for closing popups).\n      // @event preclick: MouseEvent\n      // Fired before mouse click on the map (sometimes useful when you\n      // want something to happen on click before any existing click\n      // handlers start running).\n      var synth = Util.extend({}, e);\n      synth.type = 'preclick';\n      this._fireDOMEvent(synth, synth.type, targets);\n    }\n\n    if (e._stopped) { return; }\n\n    // Find the layer the event is propagating from and its parents.\n    targets = (targets || []).concat(this._findEventTargets(e, type));\n\n    if (!targets.length) { return; }\n\n    var target = targets[0];\n    if (type === 'contextmenu' && target.listens(type, true)) {\n      DomEvent.preventDefault(e);\n    }\n\n    var data = {\n      originalEvent: e\n    };\n\n    if (e.type !== 'keypress') {\n      var isMarker = (target.options && 'icon' in target.options);\n      data.containerPoint = isMarker ?\n          this.latLngToContainerPoint(target.getLatLng()) : this.mouseEventToContainerPoint(e);\n      data.layerPoint = this.containerPointToLayerPoint(data.containerPoint);\n      data.latlng = isMarker ? target.getLatLng() : this.layerPointToLatLng(data.layerPoint);\n    }\n\n    for (var i = 0; i < targets.length; i++) {\n      targets[i].fire(type, data, true);\n      if (data.originalEvent._stopped ||\n        (targets[i].options.nonBubblingEvents && Util.indexOf(targets[i].options.nonBubblingEvents, type) !== -1)) { return; }\n    }\n  },\n\n  getFixedBookPanelSize: function() {\n    // have to make the book \n    var style = window.getComputedStyle(this._panes['book']);\n    var h = this._panes['book'].clientHeight - parseFloat(style.paddingTop) - parseFloat(style.paddingBottom);\n    var w = this._panes['book'].clientWidth - parseFloat(style.paddingRight) - parseFloat(style.paddingLeft);\n    return { height: Math.floor(h * 1.00), width: Math.floor(w * 1.00) };\n  },\n\n  invalidateSize: function(options) {\n    // TODO: IS THIS EVER USED?\n    var self = this;\n\n    if ( ! self._drawn ) { return; }\n\n    Util.cancelAnimFrame(this._resizeRequest);\n\n    if (! this._loaded) { return this; }\n\n    this.fire('resized');\n  },\n\n  _resizeBookPane: function() {\n\n  },\n\n  _setupHooks: function() {\n\n  },\n\n  _checkFeatureCompatibility: function() {\n    if ( ! DomUtil.isPropertySupported('columnCount') || this._checkMobileDevice() ) {\n      // force\n      this.options.flow = 'scrolled-doc';\n    }\n    if ( this._checkMobileDevice() ) {\n      this.options.fontSizeLarge = '160%';\n      this.options.fontSizeSmall ='100%';\n      this.options.fontSizeDefault = '120%';\n    }\n  },\n\n  _checkMobileDevice: function() {\n    if ( this._isMobile === undefined ) {\n      this._isMobile = false;\n      if ( this.options.mobileMediaQuery ) {\n        this._isMobile = window.matchMedia(this.options.mobileMediaQuery).matches;\n      }\n    }\n    return this._isMobile;\n  },\n\n  _initLoader: function() {\n    // is this not awesome?\n    var template = `<div class=\"socket\">\n      <div class=\"gel center-gel\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c1 r1\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c2 r1\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c3 r1\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c4 r1\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c5 r1\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c6 r1\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      \n      <div class=\"gel c7 r2\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      \n      <div class=\"gel c8 r2\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c9 r2\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c10 r2\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c11 r2\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c12 r2\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c13 r2\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c14 r2\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c15 r2\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c16 r2\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c17 r2\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c18 r2\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c19 r3\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c20 r3\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c21 r3\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c22 r3\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c23 r3\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c24 r3\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c25 r3\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c26 r3\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c28 r3\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c29 r3\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c30 r3\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c31 r3\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c32 r3\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c33 r3\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c34 r3\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c35 r3\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c36 r3\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n      <div class=\"gel c37 r3\">\n        <div class=\"hex-brick h1\"></div>\n        <div class=\"hex-brick h2\"></div>\n        <div class=\"hex-brick h3\"></div>\n      </div>\n    </div>`;\n\n    var body = new DOMParser().parseFromString(template, \"text/html\").body;\n    while ( body.children.length ) {\n      this._panes['loader'].appendChild(body.children[0]);\n    }\n  },\n\n  EOT: true\n});\n\nexport function createReader(id, options) {\n  return new Reader(id, options);\n}\n","import {Class} from '../core/Class';\nimport {Reader} from '../reader/Reader';\nimport * as Util from '../core/Util';\nimport * as DomUtil from '../dom/DomUtil';\n\n/*\n * @class Control\n * @aka L.Control\n * @inherits Class\n *\n * L.Control is a base class for implementing reader controls. Handles regioning.\n * All other controls extend from this class.\n */\n\nexport var Control = Class.extend({\n    // @section\n    // @aka Control options\n    options: {\n        // @option region: String = 'topright'\n        // The region of the control (one of the reader corners). Possible values are `'topleft'`,\n        // `'topright'`, `'bottomleft'` or `'bottomright'`\n    },\n\n    initialize: function (options) {\n        Util.setOptions(this, options);\n        if ( options.container ) {\n            this._container = options.container;\n            this._locked = true;\n        }\n        this._id = (new Date()).getTime() + '-' + parseInt(Math.random((new Date()).getTime()) * 1000, 10);\n    },\n\n    /* @section\n     * Classes extending L.Control will inherit the following methods:\n     *\n     * @method getRegion: string\n     * Returns the region of the control.\n     */\n    getRegion: function () {\n        return this.options.region;\n    },\n\n    // @method setRegion(region: string): this\n    // Sets the region of the control.\n    setRegion: function (region) {\n        var reader = this._reader;\n\n        if (reader) {\n            reader.removeControl(this);\n        }\n\n        this.options.region = region;\n\n        if (reader) {\n            reader.addControl(this);\n        }\n\n        return this;\n    },\n\n    // @method getContainer: HTMLElement\n    // Returns the HTMLElement that contains the control.\n    getContainer: function () {\n        return this._container;\n    },\n\n    // @method addTo(reader: Map): this\n    // Adds the control to the given reader.\n    addTo: function (reader) {\n        this.remove();\n        this._reader = reader;\n\n        var container = this._container = this.onAdd(reader);\n\n        DomUtil.addClass(container, 'cozy-control');\n\n        if ( ! this._locked ) {\n            var region = this.getRegion();\n            var area = reader.getControlRegion(region);\n            area.appendChild(container);\n        }\n\n        return this;\n    },\n\n    // @method remove: this\n    // Removes the control from the reader it is currently active on.\n    remove: function () {\n        if (!this._reader) {\n            return this;\n        }\n\n        if (! this._container) {\n            return this;\n        }\n\n        if ( ! this._locked ) {\n            DomUtil.remove(this._container);\n        }\n\n        if (this.onRemove) {\n            this.onRemove(this._reader);\n        }\n\n        this._reader = null;\n\n        return this;\n    },\n\n    _refocusOnMap: function (e) {\n        // if reader exists and event is not a keyboard event\n        if (this._reader && e && e.screenX > 0 && e.screenY > 0) {\n            this._reader.getContainer().focus();\n        }\n    },\n\n    _className: function(widget) {\n        var className = [ 'cozy-control' ];\n        if ( this.options.direction ) {\n            className.push('cozy-control-' + this.options.direction);\n        }\n        if ( widget ) {\n            className.push('cozy-control-' + widget);\n        }\n        return className.join(' ');\n    }\n});\n\nexport var control = function (options) {\n    return new Control(options);\n};\n\n/* @section Extension methods\n * @uninheritable\n *\n * Every control should extend from `L.Control` and (re-)implement the following methods.\n *\n * @method onAdd(reader: Map): HTMLElement\n * Should return the container DOM element for the control and add listeners on relevant reader events. Called on [`control.addTo(reader)`](#control-addTo).\n *\n * @method onRemove(reader: Map)\n * Optional method. Should contain all clean up code that removes the listeners previously added in [`onAdd`](#control-onadd). Called on [`control.remove()`](#control-remove).\n */\n\n/* @namespace Map\n * @section Methods for Layers and Controls\n */\nReader.include({\n    // @method addControl(control: Control): this\n    // Adds the given control to the reader\n    addControl: function (control) {\n        control.addTo(this);\n        return this;\n    },\n\n    // @method removeControl(control: Control): this\n    // Removes the given control from the reader\n    removeControl: function (control) {\n        control.remove();\n        return this;\n    },\n\n    getControlContainer: function() {\n        var l = 'cozy-';\n        if ( ! this._controlContainer ) {\n            this._controlContainer =\n                DomUtil.create('div', l + 'control-container', this._container);\n        }\n        return this._controlContainer;\n    },\n\n    getControlRegion: function (target) {\n\n        if ( ! this._panes[target] ) {\n            // target is dot-delimited string\n            // first dot is the panel\n            var parts = target.split('.');\n            var tmp = [];\n            var parent = this._container;\n            var x = 0;\n            while ( parts.length ) {\n                var slug = parts.shift();\n                tmp.push(slug);\n                var panel = tmp.join(\".\");\n                var className = 'cozy-panel-' + slug;\n                if ( ! this._panes[panel] ) {\n                    this._panes[panel] = DomUtil.create('div', className, parent);\n                }\n                parent = this._panes[panel];\n                x += 1;\n                if ( x > 100 ) { break; }\n            }\n        }\n        return this._panes[target];\n    },\n\n    getControlRegion_1: function (target) {\n\n        var tmp = target.split('.');\n        var region = tmp.shift();\n        var slot = tmp.pop() || '-slot';\n\n        var container = this._panes[region];\n        if ( ! this._panes[target] ) {\n            var className = 'cozy-' + region + '--item cozy-slot-' + slot\n            if ( ! this._panes[region + '.' + slot] ) {\n                var div = DomUtil.create('div', className);\n                if ( slot == 'left' || slot == 'bottom' ) {\n                    var childElement = this._panes[region].firstChild;\n                    this._panes[region].insertBefore(div, childElement);\n                } else {\n                    this._panes[region].appendChild(div);\n                }\n                this._panes[region + '.' + slot] = div;\n            }\n            className = this._classify(tmp);\n            this._panes[target] = DomUtil.create('div', className, this._panes[region + '.' + slot]);\n        }\n\n        return this._panes[target];\n    },\n\n    _classify: function(tmp) {\n        var l = 'cozy-';\n        var className = [];\n        for(var i in tmp) {\n            className.push(l + tmp[i]);\n        }\n        className = className.join(' ');\n        return className;\n    },\n\n    _clearControlRegion: function () {\n        for (var i in this._controlRegions) {\n            DomUtil.remove(this._controlRegions[i]);\n        }\n        DomUtil.remove(this._controlContainer);\n        delete this._controlRegions;\n        delete this._controlContainer;\n    }\n});\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nvar PageControl = Control.extend({\n  onAdd: function(reader) {\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n      container = DomUtil.create('div', className),\n\n      this._control  = this._createButton(this._fill(options.html || options.label), this._fill(options.label),\n              className, container);\n    }\n    this._bindEvents();\n\n    return container;\n  },\n\n  _createButton: function (html, title, className, container) {\n    var link = DomUtil.create('a', className, container);\n    link.innerHTML = html;\n    link.href = '#';\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    return link;\n  },\n\n  _bindEvents: function() {\n    var self = this;\n    DomEvent.disableClickPropagation(this._control);\n    DomEvent.on(this._control, 'click', DomEvent.stop);\n    DomEvent.on(this._control, 'click', this._action, this);\n\n    this._reader.on('reopen', function(data) {\n      // update the button text / titles\n      var html = self.options.html || self.options.label;\n      self._control.innerHTML = self._fill(html);\n      self._control.setAttribute('title', self._fill(self.options.label));\n      self._control.setAttribute('aria-label', self._fill(self.options.label));\n    });\n\n  },\n\n  _unit: function() {\n    return ( this._reader.options.flow == 'scrolled-doc' ) ? 'Section' : 'Page';\n  },\n\n  _fill: function(s) {\n    var unit = this._unit();\n    return s.replace(/\\$\\{unit\\}/g, unit);\n  },\n\n  _label: function() {\n    return this.options.label + \" \" + ( this._reader.options.flow == 'scrolled-doc' ) ? 'Section' : 'Page';\n  },\n\n  EOT: true\n});\n\nexport var PagePrevious = PageControl.extend({\n  options: {\n    region: 'edge.left',\n    direction: 'previous',\n    label: 'Previous ${unit}',\n    html: '<i class=\"icon-chevron-left oi\" data-glyph=\"chevron-left\" title=\"Previous ${unit}\" aria-hidden=\"true\"></i>'\n  },\n\n  _action: function(e) {\n    this._reader.prev();\n  }\n});\n\nexport var PageNext = PageControl.extend({\n  options: {\n    region: 'edge.right',\n    direction: 'next',\n    label: 'Next ${unit}',\n    html: '<i class=\"icon-chevron-right oi\" data-glyph=\"chevron-right\" title=\"Next ${unit}\" aria-hidden=\"true\"></i>'\n  },\n\n  _action: function(e) {\n    this._reader.next();\n  }\n});\n\nexport var PageFirst = PageControl.extend({\n  options: {\n    direction: 'first',\n    label: 'First ${unit}'\n  },\n  _action: function(e) {\n      this._reader.first();\n  }\n});\n\nexport var PageLast = PageControl.extend({\n  options: {\n    direction: 'last',\n    label: 'Last ${unit}'\n  },\n  _action: function(e) {\n      this._reader.last();\n  }\n});\n\nexport var pageNext = function(options) {\n  return new PageNext(options);\n}\n\nexport var pagePrevious = function(options) {\n  return new PagePrevious(options);\n}\n\nexport var pageFirst = function(options) {\n  return new PageFirst(options);\n}\n\nexport var pageLast = function(options) {\n  return new PageLast(options);\n}\n","import {Class} from '../core/Class';\nimport {Reader} from '../reader/Reader';\nimport * as Util from '../core/Util';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\n\nvar activeModal;\nvar dismissModalListener = false;\n\n// from https://github.com/ghosh/micromodal/blob/master/src/index.js\nconst FOCUSABLE_ELEMENTS = [\n    'a[href]',\n    'area[href]',\n    'input:not([disabled]):not([type=\"hidden\"])',\n    'select:not([disabled])',\n    'textarea:not([disabled])',\n    'button:not([disabled])',\n    'iframe',\n    'object',\n    'embed',\n    '[contenteditable]',\n    '[tabindex]:not([tabindex^=\"-\"])'\n  ];\n\nconst ACTIONABLE_ELEMENTS = [\n    'a[href]',\n    'area[href]',\n    'input[type=\"submit\"]:not([disabled])',\n    'button:not([disabled])'\n  ];\n\nexport var Modal = Class.extend({\n  options: {\n    // @option region: String = 'topright'\n    // The region of the control (one of the reader edges). Possible values are `'left' ad 'right'`\n    region: 'left',\n    fraction: 0,\n    width: null,\n    className: {},\n    actions: null,\n    callbacks: { onShow: function() {}, onClose: function() {} },\n    handlers: {}\n  },\n\n  initialize: function (options) {\n    options = Util.setOptions(this, options);\n    this._id = (new Date()).getTime() + '-' + parseInt(Math.random((new Date()).getTime()) * 1000, 10);\n    this._initializedEvents = false;\n    this.callbacks = this.options.callbacks;\n    this.actions = this.options.actions;\n    this.handlers = this.options.handlers;\n    if ( typeof(this.options.className) == 'string' ) {\n      this.options.className = { container: this.options.className };\n    }\n  },\n\n  addTo: function(reader) {\n    var self = this;\n    this._reader = reader;\n    var template = this.options.template;\n\n    var panelHTML = `<div class=\"cozy-modal modal-slide ${this.options.region || 'left'}\" id=\"modal-${this._id}\" aria-labelledby=\"modal-${this._id}-title\" role=\"dialog\" aria-describedby=\"modal-${this._id}-content\" aria-hidden=\"true\">\n      <div class=\"modal__overlay\" tabindex=\"-1\" data-modal-close>\n        <div class=\"modal__container ${this.options.className.container ? this.options.className.container : ''}\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"modal-${this._id}-title\" aria-describedby=\"modal-${this._id}-content\" id=\"modal-${this._id}-container\">\n          <div role=\"document\">\n            <header class=\"modal__header\">\n              <h3 class=\"modal__title\" id=\"modal-${this._id}-title\">${this.options.title}</h3>\n              <button class=\"modal__close\" aria-label=\"Close modal\" aria-controls=\"modal-${this._id}-container\" data-modal-close></button>\n            </header>\n            <main class=\"modal__content ${this.options.className.main ? this.options.className.main : ''}\" id=\"modal-${this._id}-content\">\n              ${template}\n            </main>`;\n\n    if ( this.options.actions ) {\n      panelHTML += '<footer class=\"modal__footer\">'\n      for(var i in this.options.actions) {\n        var action = this.options.actions[i];\n        var button_cls = action.className || 'button--default';\n        panelHTML += `<button id=\"action-${this._id}-${i}\" class=\"button button--lg ${button_cls}\">${action.label}</button>`;\n      }\n      panelHTML += '</footer>';\n    }\n\n    panelHTML += '</div></div></div></div>';\n\n    var body = new DOMParser().parseFromString(panelHTML, \"text/html\").body;\n\n    this.modal = reader._container.appendChild(body.children[0]);\n    this._container = this.modal; // compatibility\n\n    this.container = this.modal.querySelector('.modal__container');\n    this._bindEvents();\n    return this;\n  },\n\n  _bindEvents: function() {\n    var self = this;\n    this.onClick = this.onClick.bind(this);\n    this.onKeydown = this.onKeydown.bind(this);\n    this.onModalTransition = this.onModalTransition.bind(this);\n\n    this.modal.addEventListener('transitionend', function() {\n    }.bind(this));\n\n    // bind any actions\n    if ( this.actions ) {\n      for(var i in this.actions) {\n        let action = this.actions[i];\n        let button_id = '#action-' + this._id + '-' + i;\n        let button = this.modal.querySelector(button_id);\n        if ( button ) {\n          DomEvent.on(button, 'click', function(event) {\n            event.preventDefault();\n            action.callback(event);\n            if ( action.close ) {\n              self.closeModal();\n            }\n          })\n        }\n      }\n    }\n  },\n\n  deactivate: function() {\n    this.closeModal();\n  },\n\n  closeModal: function() {\n    var self = this;\n    this.modal.setAttribute('aria-hidden', 'true');\n    this.removeEventListeners();\n    this.activeElement.focus();\n    this.callbacks.onClose(this.modal);\n  },\n\n  showModal: function() {\n    this.activeElement = document.activeElement\n    this._resize();\n    this.modal.setAttribute('aria-hidden', 'false')\n    this.setFocusToFirstNode()\n    this.addEventListeners()\n    this.callbacks.onShow(this.modal)\n  },\n\n  activate: function() {\n    return this.showModal();\n    var self = this;\n    activeModal = this;\n    DomUtil.addClass(self._reader._container, 'st-modal-activating');\n    this._resize();\n    DomUtil.addClass(this._reader._container, 'st-modal-open');\n    setTimeout(function() {\n      DomUtil.addClass(self._container, 'active');\n      DomUtil.removeClass(self._reader._container, 'st-modal-activating');\n      self._container.setAttribute('aria-hidden', 'false');\n      self.setFocusToFirstNode();\n    }, 25);\n  },\n\n  addEventListeners: function () {\n    // --- do we need touch listeners?\n    // this.modal.addEventListener('touchstart', this.onClick)\n    // this.modal.addEventListener('touchend', this.onClick)\n    this.modal.addEventListener('click', this.onClick)\n    document.addEventListener('keydown', this.onKeydown)\n    'webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend'.split(' ').forEach(function(event) {\n      this.modal.addEventListener(event, this.onModalTransition);\n    }.bind(this))\n  },\n\n  removeEventListeners: function () {\n    this.modal.removeEventListener('touchstart', this.onClick)\n    this.modal.removeEventListener('click', this.onClick)\n    'webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend'.split(' ').forEach(function(event) {\n      this.modal.removeEventListener(event, this.onModalTransition);\n    }.bind(this))\n    document.removeEventListener('keydown', this.onKeydown)\n  },\n\n  _resize: function() {\n    var container = this._reader._container;\n    this.container.style.height = container.offsetHeight + 'px';\n    if ( ! this.options.className.container  ) {\n      this.container.style.width = this.options.width || parseInt(container.offsetWidth * this.options.fraction) + 'px';\n    }\n\n    var header = this.container.querySelector('header');\n    var footer = this.container.querySelector('footer');\n    var main = this.container.querySelector('main');\n    var height = this.container.clientHeight - header.clientHeight;\n    if ( footer ) {\n      height -= footer.clientHeight;\n    }\n    main.style.height = height + 'px';\n  },\n\n  getFocusableNodes: function() {\n    const nodes = this.modal.querySelectorAll(FOCUSABLE_ELEMENTS);\n    return Object.keys(nodes).map((key) => nodes[key]);\n  },\n\n  setFocusToFirstNode: function() {\n    var focusableNodes = this.getFocusableNodes();\n    if ( focusableNodes.length ) {\n      focusableNodes[0].focus();\n    } else {\n      activeModal._container.focus();\n    }\n  },\n\n  getActionableNodes: function() {\n    const nodes = this.modal.querySelectorAll(ACTIONABLE_ELEMENTS);\n    return Object.keys(nodes).map((key) => nodes[key]);\n  },\n\n  onKeydown: function(event) {\n    if ( event.keyCode == 27 ) { this.closeModal(); }\n    if ( event.keyCode == 9 ) {\n      this.maintainFocus(event);\n    }\n  },\n\n  onClick: function(event) {\n\n    var closeAfterAction = false;\n    var target = event.target;\n\n    // As far as I can tell, the code below isn't catching direct clicks on\n    // items with class='data-modal-close' as they're not ACTIONABLE_ELEMENTS.\n    // Adding them to ACTIONABLE_ELEMENTS causes undesirable behavior where\n    // their child items also close the modal thanks to the loop below.\n    // Children of .modal__overlay include the modal header, border area and\n    // padding. We don't want clicks on these closing the modal.\n    // Just close the modal now for direct clicks on a '.data-modal-close'.\n    if (target.hasAttribute('data-modal-close')) {\n      this.closeModal();\n      return;\n    }\n\n    // if the target isn't an actionable type, walk the DOM until\n    // one is found\n    var actionableNodes = this.getActionableNodes();\n    while ( actionableNodes.indexOf(target) < 0 && target != this.modal ) {\n      target = target.parentElement;\n    }\n\n    // no target found, punt\n    if ( actionableNodes.indexOf(target) < 0 ) {\n      return;\n    }\n\n    if (this.handlers.click) {\n      var did_match = false;\n      for(var selector in this.handlers.click) {\n        if ( target.matches(selector) ) {\n          closeAfterAction = this.handlers.click[selector](this, target);\n          break;\n        }\n      }\n    }\n\n    if (closeAfterAction || target.hasAttribute('data-modal-close')) this.closeModal();\n\n    event.preventDefault();\n  },\n\n  onModalTransition: function(event) {\n    if ( this.modal.getAttribute('aria-hidden') == 'true' ) {\n      this._reader.fire('modal-closed');\n    } else {\n      this._reader.fire('modal-opened');\n    }\n  },\n\n  on: function(event, selector, handler) {\n    if (! this.handlers[event] ) {\n      this.handlers[event] = {};\n    }\n    this.handlers[event][selector] = handler;\n  },\n\n  maintainFocus: function(event) {\n    var focusableNodes = this.getFocusableNodes();\n    var focusedItemIndex = focusableNodes.indexOf(document.activeElement);\n    if (event.shiftKey && focusedItemIndex === 0) {\n      focusableNodes[focusableNodes.length - 1].focus()\n      event.preventDefault()\n    }\n\n    if (!event.shiftKey && focusedItemIndex === focusableNodes.length - 1) {\n      focusableNodes[0].focus()\n      event.preventDefault()\n    }\n  },\n\n  EOT: true\n});\n\nReader.include({\n  modal: function (options) {\n    var modal = new Modal(options);\n    return modal.addTo(this);\n    // return this;\n  },\n\n  EOT: true\n});\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport {Modal} from './Modal';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Contents = Control.extend({\n\n  defaultTemplate: `<button class=\"button--sm\" data-toggle=\"open\" aria-label=\"Table of Contents\"><i class=\"icon-menu oi\" data-glyph=\"menu\" title=\"Table of Contents\" aria-hidden=\"true\"></i></button>`,\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    this._control.setAttribute('id', 'action-' + this._id);\n    container.style.position = 'relative';\n\n    this._reader.on('updateContents', function(data) {\n\n      DomEvent.on(this._control, 'click', function(event) {\n        event.preventDefault();\n        self._modal.activate();\n      }, this)\n\n      this._modal = this._reader.modal({\n        template: '<ul></ul>',\n        title: 'Contents',\n        region: 'left',\n        className: 'cozy-modal-contents'\n      });\n\n      this._modal.on('click', 'a[href]', function(modal, target) {\n        target = target.getAttribute('href');\n        this._reader.gotoPage(target);\n        return true;\n      }.bind(this))\n\n      this._setupSkipLink();\n\n      var parent = self._modal._container.querySelector('ul');\n      var s = data.toc.filter(function(value) { return value.parent == null }).map(function(value) { return [ value, 0, parent ] });\n      while ( s.length ) {\n        var tuple = s.shift();\n        var chapter = tuple[0];\n        var tabindex = tuple[1];\n        var parent = tuple[2];\n\n        var option = self._createOption(chapter, tabindex, parent);\n        data.toc.filter(function(value) { return value.parent == chapter.id }).reverse().forEach(function(chapter_) {\n          s.unshift([chapter_, tabindex + 1, option]);\n        });\n      }\n    }.bind(this))\n\n    return container;\n  },\n\n  _createOption(chapter, tabindex, parent) {\n\n    function pad(value, length) {\n        return (value.toString().length < length) ? pad(\"-\"+value, length):value;\n    }\n    var option = DomUtil.create('li');\n    var anchor = DomUtil.create('a', null, option);\n    anchor.textContent = chapter.label;\n    // var tab = pad('', tabindex); tab = tab.length ? tab + ' ' : '';\n    // option.textContent = tab + chapter.label;\n    anchor.setAttribute('href', chapter.href);\n\n    if ( parent.tagName == 'LI' ) {\n      // need to nest\n      var tmp = parent.querySelector('ul');\n      if ( ! tmp ) {\n        tmp = DomUtil.create('ul', null, parent);\n      }\n      parent = tmp;\n    }\n\n    parent.appendChild(option);\n    return option;\n  },\n\n  _setupSkipLink: function() {\n    if ( ! this.options.skipLink ) { return; }\n      \n    var target = document.querySelector(this.options.skipLink);\n    if ( ! target ) { return; }\n\n    var link = document.createElement('a');\n    link.textContent = 'Skip to contents';\n    link.setAttribute('href', '#action-' + this._id);\n\n    var ul = target.querySelector('ul');\n    if ( ul ) {\n      // add to list\n      target = document.createElement('li');\n      ul.appendChild(target);\n    }\n    target.appendChild(link);\n    link.addEventListener('click', function(event) {\n      event.preventDefault();\n      event.stopPropagation();\n      this._control.click();\n    }.bind(this))\n\n  },\n\n  EOT: true\n});\n\nexport var contents = function(options) {\n  return new Contents(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\n// Title + Chapter\n\nexport var Title = Control.extend({\n  onAdd: function(reader) {\n    var self = this;\n    var className = this._className(),\n        container = DomUtil.create('div', className),\n        options = this.options;\n\n    // var template = '<h1><span class=\"cozy-title\">Contents: </span><select size=\"1\" name=\"contents\"></select></label>';\n    // var control = new DOMParser().parseFromString(template, \"text/html\").body.firstChild;\n\n    var h1 = DomUtil.create('h1', 'cozy-h1', container);\n    this._title = DomUtil.create('span', 'cozy-title', h1);\n    this._divider = DomUtil.create('span', 'cozy-divider', h1);\n    this._divider.textContent = \" · \";\n    this._section = DomUtil.create('span', 'cozy-section', h1);\n\n    this._reader.on('updateSection', function(data) {\n      if ( data && data.label ) {\n        self._section.textContent = data.label;\n        DomUtil.setOpacity(self._section, 1.0);\n        DomUtil.setOpacity(self._divider, 1.0);\n      } else {\n        DomUtil.setOpacity(self._section, 0);\n        DomUtil.setOpacity(self._divider, 0);\n      }\n    })\n\n    this._reader.on('updateTitle', function(data) {\n      if ( data ) {\n        self._title.textContent = data.title || data.bookTitle;\n        DomUtil.setOpacity(self._section, 0);\n        DomUtil.setOpacity(self._divider, 0);\n      }\n    })\n\n    return container;\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('a', className, container);\n    link.innerHTML = html;\n    link.href = '#';\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n    // DomEvent.on(link, 'click', this._refocusOnMap, this);\n\n    return link;\n  },\n\n  EOT: true\n});\n\nexport var title = function(options) {\n  return new Title(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\n// Title + Chapter\n\nexport var PublicationMetadata = Control.extend({\n  onAdd: function(reader) {\n    var self = this;\n    var className = this._className(),\n        container = DomUtil.create('div', className),\n        options = this.options;\n\n    // var template = '<h1><span class=\"cozy-title\">Contents: </span><select size=\"1\" name=\"contents\"></select></label>';\n    // var control = new DOMParser().parseFromString(template, \"text/html\").body.firstChild;\n\n    this._publisher = DomUtil.create('div', 'cozy-publisher', container);\n    this._rights = DomUtil.create('div', 'cozy-rights', container);\n\n    this._reader.on('updateTitle', function(data) {\n      if ( data ) {\n        self._publisher.textContent = data.publisher;\n        self._rights.textContent = data.rights;\n      }\n    })\n\n    return container;\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('a', className, container);\n    link.innerHTML = html;\n    link.href = '#';\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n    // DomEvent.on(link, 'click', this._refocusOnMap, this);\n\n    return link;\n  },\n\n  EOT: true\n});\n\nexport var publicationMetadata = function(options) {\n  return new PublicationMetadata(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Preferences = Control.extend({\n  options: {\n    label: 'Preferences',\n    hasThemes: false,\n    html: '<i class=\"icon-cog oi\" data-glyph=\"cog\" title=\"Preferences and Settings\" aria-hidden=\"true\"></i>'\n  },\n\n  onAdd: function(reader) {\n    var self = this;\n    var className = this._className('preferences'),\n        container = DomUtil.create('div', className),\n        options = this.options;\n\n    this._activated = false;\n    this._control = this._createButton(options.html || options.label, options.label,\n            className, container, this._action)\n\n    this._createPanel();\n\n    return container;\n  },\n\n  _action: function() {\n    var self = this;\n    self._modal.activate();\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('button', className, container);\n    link.innerHTML = html;\n    link.title = title;\n\n    /*\n     * Will force screen readers like VoiceOver to read this as \"Zoom in - button\"\n     */\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n\n    return link;\n  },\n\n  _createPanel: function() {\n    var self = this;\n    var template = `<fieldset>\n        <legend>Text Size</legend>\n        <label><input name=\"text_size\" type=\"radio\" id=\"preferences-input-size-small\" value=\"small\" />Small</label>\n        <label><input name=\"text_size\" type=\"radio\" id=\"preferences-input-size-auto\" value=\"auto\" />Default</label>\n        <label><input name=\"text_size\" type=\"radio\" id=\"preferences-input-size-large\" value=\"large\" />Large</label>\n      </fieldset>          \n      <fieldset>\n        <legend>Text Display</legend>\n        <label><input name=\"flow\" type=\"radio\" id=\"preferences-input-paginated\" value=\"paginated\" />Page-by-Page</label>\n        <label><input name=\"flow\" type=\"radio\" id=\"preferences-input-scrolled-doc\" value=\"scrolled-doc\" />Scroll</label>\n      </fieldset>`;\n\n    if ( this._reader.options.themes && this._reader.options.themes.length > 0 ) {\n      self.options.hasThemes = true;\n      template += `<fieldset>\n        <legend>Theme</legend>\n        <label><input name=\"theme\" type=\"radio\" id=\"preferences-input-theme-default\" value=\"default\" />Default</label>`;\n      \n      this._reader.options.themes.forEach(function(theme) {\n        template += `<label><input name=\"theme\" type=\"radio\" id=\"preferences-input-theme-${theme.klass}\" value=\"${theme.klass}\" />${theme.name}</label>`\n      })\n\n      template += '</fieldset>';\n    }\n\n    template = '<form>' + template + '</form>';\n\n    this._modal = this._reader.modal({\n      template: template,\n      title: 'Preferences',\n      className: 'cozy-modal-preferences',\n      actions: [\n        {\n          label: 'Save Changes',\n          callback: function(event) {\n            self._updatePreferences(event);\n          }\n        }\n      ],\n      region: 'right'\n    });\n\n    this._form = this._modal._container.querySelector('form');\n    this._initializeForm();\n\n    window.xmodal = this._modal;\n  },\n\n  _initializeForm: function() {\n    var input, input_id;\n    /// input_id = \"preferences-input-\" + ( this._reader.options.flow == 'scrolled-doc' ? 'scrollable' : 'reflowable' );\n    input_id = \"preferences-input-\" + ( this._reader.options.flow == 'auto' ? 'paginated' : 'scrolled-doc' );\n    input = this._form.querySelector(\"#\" + input_id);\n    input.checked = true;\n\n    input_id = \"preferences-input-size-\" + ( this._reader.options.text_size || 'auto' );\n    input = this._form.querySelector(\"#\" + input_id);\n    input.checked = true;\n\n    if ( this.options.hasThemes ) {\n      input_id = \"preferences-input-theme-\" + ( this._reader.options.theme || 'default' );\n      input = this._form.querySelector(\"#\" + input_id);\n      input.checked = true;\n    }\n  },\n\n  _updatePreferences: function(event) {\n    var self = this;\n    event.preventDefault();\n\n    var options = {};\n    var input = this._form.querySelector(\"input[name='flow']:checked\");\n    options.flow = input.value;\n    input = this._form.querySelector(\"input[name='text_size']:checked\");\n    options.text_size = input.value;\n    if ( this.options.hasThemes ) {\n      input = this._form.querySelector(\"input[name='theme']:checked\");\n      options.theme = input.value;\n    }\n    this._modal.deactivate();\n    setTimeout(function() {\n      self._reader.reopen(options);\n    }, 100);\n  },\n\n  EOT: true\n});\n\nexport var preferences = function(options) {\n  return new Preferences(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Widget = Control.extend({\n\n\n  options: {\n      // @option region: String = 'topright'\n      // The region of the control (one of the reader corners). Possible values are `'topleft'`,\n      // `'topright'`, `'bottomleft'` or `'bottomright'`\n  },\n\n  onAdd: function(reader) {\n    var container = this._container;\n    if ( container ) {\n      // NOOP\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n\n    }\n\n    this._onAddExtra(container);\n    this._updateTemplate(container);\n    this._updateClass(container);\n    this._bindEvents(container);\n\n    return container;\n  },\n\n  _updateTemplate: function(container) {\n    var data = this.data();\n    for(var slot in data) {\n      if ( data.hasOwnProperty(slot) ) {\n        var value = data[slot];\n        if ( typeof(value) == \"function\" ) { value = value(); }\n        var node = container.querySelector(`[data-slot=${slot}]`);\n        if ( node ) {\n          if ( node.hasAttribute('value') ) {\n            node.setAttribute('value', value);\n          } else {\n            node.innerHTML = value;\n          }\n        }\n      }\n    }\n  },\n\n  _updateClass: function(container) {\n    if ( this.options.className ) {\n      DomUtil.addClass(container, this.options.className);\n    }\n  },\n\n  _onAddExtra: function() { },\n\n  _bindEvents: function(container) {\n    var control = container.querySelector(\"[data-toggle=button]\");\n    if ( ! control ) { return ; }\n    DomEvent.disableClickPropagation(control);\n    DomEvent.on(control, 'click', DomEvent.stop);\n    DomEvent.on(control, 'click', this._action, this);\n  },\n\n  _action: function() {\n  },\n\n  data: function() {\n    return this.options.data || {};\n  },\n\n  EOT: true\n});\n\nWidget.Button = Widget.extend({\n  defaultTemplate: `<button data-toggle=\"button\" data-slot=\"label\"></button>`,\n\n  _action: function() {\n    this.options.onClick(this, this._reader);\n  },\n\n  EOT: true\n});\n\nWidget.Panel = Widget.extend({\n  defaultTemplate: `<div><span data-slot=\"text\"></span></div>`,\n\n\n  EOT: true\n});\n\nWidget.Toggle = Widget.extend({\n  defaultTemplate: `<button data-toggle=\"button\" data-slot=\"label\"></button>`,\n\n  _onAddExtra: function(container) {\n    this.state(this.options.states[0].stateName, container);\n\n    return container;\n  },\n\n  state: function(stateName, container) {\n    container = container || this._container;\n    this._resetState(container);\n    this._state = this.options.states.filter(function(s) { return s.stateName == stateName })[0];\n    this._updateClass(container);\n    this._updateTemplate(container);\n  },\n\n  _resetState: function(container) {\n    if ( ! this._state ) { return; }\n    if ( this._state.className ) {\n      DomUtil.removeClass(container, this._state.className);\n    }\n  },\n\n  _updateClass: function(container) {\n    if ( this._state.className ) {\n      DomUtil.addClass(container, this._state.className);\n    }\n  },\n\n  _action: function() {\n    this._state.onClick(this, this._reader);\n  },\n\n  data: function() {\n    return this._state.data || {};\n  },\n\n  EOT: true\n});\n\n// export var widget = function(options) {\n//   return new Widget(options);\n// }\n\nexport var widget = {\n  button: function(options) { return new Widget.Button(options); },\n  panel: function(options) { return new Widget.Panel(options); },\n  toggle: function(options) { return new Widget.Toggle(options); }\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Citation = Control.extend({\n  options: {\n    label: 'Citation',\n    html: '<span>Get Citation</span>'\n  },\n\n  defaultTemplate: `<button class=\"button--sm cozy-citation\" data-toggle=\"open\">Get Citation</button>`,\n\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._reader.on('updateContents', function(data) {\n      self._createPanel();\n    });\n\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n      self._modal.activate();\n    }, this)\n\n    return container;\n  },\n\n  _action: function() {\n    var self = this;\n    self._modal.activate();\n  },\n\n  _createButton: function (html, title, className, container, fn) {\n    var link = DomUtil.create('button', className, container);\n    link.innerHTML = html;\n    link.title = title;\n\n    link.setAttribute('role', 'button');\n    link.setAttribute('aria-label', title);\n\n    DomEvent.disableClickPropagation(link);\n    DomEvent.on(link, 'click', DomEvent.stop);\n    DomEvent.on(link, 'click', fn, this);\n\n    return link;\n  },\n\n  _createPanel: function() {\n    var self = this;\n\n    var template = `<form>\n      <fieldset>\n        <legend>Select Citation Format</legend>\n      </fieldset>\n    </form>\n    <blockquote id=\"formatted\" style=\"padding: 8px; border-left: 4px solid black; background-color: #fff\"></blockquote>\n    <div class=\"alert alert-info\" id=\"message\" style=\"display: none\"></div>`;\n\n    this._modal = this._reader.modal({\n      template: template,\n      title: 'Copy Citation to Clipboard',\n      className: 'cozy-modal-citatation',\n      actions: [\n        {\n          label: 'Copy Citation',\n          callback: function(event) {\n            document.designMode = \"on\";\n            var formatted = self._modal._container.querySelector(\"#formatted\");\n\n            var range = document.createRange();\n            range.selectNode(formatted);\n            var sel = window.getSelection();\n            sel.removeAllRanges();\n            sel.addRange(range);\n\n            // formatted.select();\n\n            try {\n              var flag = document.execCommand('copy');\n            } catch(err) {\n              console.log(\"AHOY COPY FAILED\", err);\n            }\n\n            self._message.innerHTML = 'Success! Citation copied to your clipboard.';\n            self._message.style.display = 'block';\n            sel.removeAllRanges();\n            range.detach();\n            document.designMode = \"off\";\n          }\n        }\n      ],\n      region: 'left',\n      fraction: 1.0\n    });\n\n    this._form = this._modal._container.querySelector('form');\n    var fieldset = this._form.querySelector('fieldset');\n\n    var citations = this.options.citations || this._reader.metadata.citations;\n\n    citations.forEach(function(citation, index) {\n      var label = DomUtil.create('label', null, fieldset);\n      var input = DomUtil.create('input', null, label);\n      input.setAttribute('name', 'format');\n      input.setAttribute('value', citation.format);\n      input.setAttribute('type', 'radio');\n      if ( index == 0 ) {\n        input.setAttribute('checked', 'checked');\n      }\n      var text = document.createTextNode(\" \" + citation.format);\n      label.appendChild(text);\n      input.setAttribute('data-text', citation.text);\n    });\n\n    this._formatted = this._modal._container.querySelector(\"#formatted\");\n    this._message = this._modal._container.querySelector(\"#message\");\n    DomEvent.on(this._form, 'change', function(event) {\n      var target = event.target;\n      if ( target.tagName == 'INPUT' ) {\n        this._initializeForm();\n      }\n    }, this);\n\n    this._initializeForm();\n  },\n\n  _initializeForm: function() {\n    var formatted = this._formatCitation();\n    this._formatted.innerHTML = formatted;\n    this._message.style.display = 'none';\n    this._message.innerHTML = '';\n  },\n\n  _formatCitation: function(format) {\n    if ( format == null ) {\n      var selected = this._form.querySelector(\"input:checked\");\n      format = selected.value;\n    }\n    var selected = this._form.querySelector(\"input[value=\" + format + \"]\");\n    return selected.getAttribute('data-text');\n    // return selected.dataset.text;\n  },\n\n  EOT: true\n});\n\nexport var citation = function(options) {\n  return new Citation(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Search = Control.extend({\n  options: {\n    label: 'Search',\n    html: '<span>Search</span>'\n  },\n\n  defaultTemplate: `<form class=\"search\">\n    <label class=\"u-screenreader\" for=\"cozy-search-string\">Search</label>\n    <input id=\"cozy-search-string\" name=\"search\" type=\"text\" placeholder=\"Enter Search...\"/>\n    <button class=\"button--sm\" data-toggle=\"open\" aria-label=\"Search\"><i class=\"icon-magnifying-glass oi\" data-glyph=\"magnifying-glass\" title=\"Search\" aria-hidden=\"true\"></i></button>\n  </form>`,\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    container.style.position = 'relative';\n\n    this._data = null;\n    this._canceled = false;\n    this._processing = false;\n\n    this._reader.on('ready', function() {\n\n      this._modal = this._reader.modal({\n        template: '<article></article>',\n        title: 'Search Results',\n        className: { container: 'cozy-modal-search' },\n        region: 'left',\n      });\n\n      this._modal.callbacks.onClose = function() {\n        if ( self._processing ) {\n          self._canceled = true;\n        }\n      };\n\n      this._article = this._modal._container.querySelector('article');\n\n      this._modal.on('click', 'a[href]', function(modal, target) {\n        target = target.getAttribute('href');\n        this._reader.gotoPage(target);\n        return true;\n      }.bind(this));\n\n    }.bind(this));\n\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n\n      var searchString = this._container.querySelector(\"#cozy-search-string\").value;\n      searchString = searchString.replace(/^\\s*/, '').replace(/\\s*$/, '');\n\n      if ( ! searchString ) {\n        // just punt\n        return;\n      }\n\n      if ( searchString == this.searchString ) {\n        // cached results\n        self.openModalResults();\n      } else {\n        this.searchString = searchString;\n        self.openModalWaiting();\n        self.submitQuery();\n      }\n    }, this);\n\n    return container;\n  },\n\n  openModalWaiting: function() {\n    this._processing = true;\n    this._emptyArticle();\n    var value = this.searchString;\n    this._article.innerHTML = '<p class=\"spinner\">Submitting query for <em>' + value + '</em>...</p>';\n    this._modal.activate();\n  },\n\n  openModalResults: function() {\n    if ( this._canceled ) {\n      this._canceled = false;\n      return;\n    }\n    this._buildResults();\n    this._modal.activate();\n  },\n\n  submitQuery: function() {\n    var self = this;\n\n    var url = this.options.searchUrl + this.searchString;\n\n    var request = new XMLHttpRequest();\n    request.open('GET', url, true);\n\n    request.onload = function() {\n      if (this.status >= 200 && this.status < 400) {\n        // Success!\n        var data = JSON.parse(this.response);\n        console.log(\"SEARCH DATA\", data);\n\n        self._data = data;\n\n      } else {\n        // We reached our target server, but it returned an error\n\n        self._data = null;\n        console.log(this.response);\n      }\n\n      self.openModalResults();\n\n    };\n\n    request.onerror = function() {\n      // There was a connection error of some sort\n      self._data = null;\n      self.openModalResults();\n    };\n\n    request.send();\n\n  },\n\n  _emptyArticle: function() {\n    while (this._article.hasChildNodes()) {\n      this._article.removeChild(this._article.lastChild);\n    }\n  },\n\n  _buildResults: function() {\n    var self = this;\n    var content;\n\n    this._processing = false;\n\n    self._emptyArticle();\n\n    var reader = this._reader;\n    reader.annotations.reset();\n\n    if ( this._data ) {\n      if ( this._data.search_results.length ) {\n        content = DomUtil.create('ul');\n\n        this._data.search_results.forEach(function(result) {\n          var option = DomUtil.create('li');\n          var anchor = DomUtil.create('a', null, option);\n          var cfiRange = \"epubcfi(\" + result.cfi + \")\";\n\n          if (result.title) {\n            var chapterTitle = DomUtil.create('i');\n            chapterTitle.textContent = result.title + \": \";\n            anchor.appendChild(chapterTitle);\n          }\n          anchor.appendChild(document.createTextNode(result.snippet));\n\n          anchor.setAttribute(\"href\", cfiRange);\n          content.appendChild(option);\n\n          reader.annotations.highlight(cfiRange);\n        });\n      } else {\n        content = DomUtil.create(\"p\")\n        content.textContent = 'No results found for \"' + self.searchString + '\"';\n      }\n    } else {\n      content = DomUtil.create(\"p\")\n      content.textContent = 'There was a problem processing this query.';\n    }\n\n    self._article.appendChild(content);\n  },\n\n  EOT: true\n});\n\nexport var search = function(options) {\n  return new Search(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\n// Title + Chapter\n\nexport var BibliographicInformation = Control.extend({\n  options: {\n    label: 'Info',\n    direction: 'left',\n    html: '<span class=\"oi\" data-glyph=\"info\">Info</span>'\n  },\n\n  defaultTemplate: `<button class=\"button--sm cozy-bib-info oi\" data-glyph=\"info\" data-toggle=\"open\" aria-label=\"Bibliographic Information\"> Info</button>`,\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._reader.on('updateContents', function(data) {\n      self._createPanel();\n    });\n\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n      self._modal.activate();\n    }, this)\n\n    return container;\n  },\n\n  _createPanel: function() {\n    var self = this;\n\n    var template = `<dl>\n    </dl>`;\n\n    this._modal = this._reader.modal({\n      template: template,\n      title: 'Info',\n      region: 'left',\n      fraction: 1.0\n    });\n\n    var dl = this._modal._container.querySelector('dl');\n\n    var metadata_fields = [\n      [ 'title', 'Title' ],\n      [ 'creator', 'Author' ],\n      [ 'pubdate', 'Publication Date' ],\n      [ 'modified_date', 'Modified Date' ],\n      [ 'publisher', 'Publisher' ],\n      [ 'rights', 'Rights' ],\n      [ 'doi', 'DOI' ],\n      [ 'description', 'Description' ],\n    ];\n\n    var metadata_fields_seen = {};\n\n    var metadata = this._reader.metadata;\n\n    var dateFormat = new Intl.DateTimeFormat('en-US', {\n      year: 'numeric', month: '2-digit', day: '2-digit'\n    });\n\n    for(var idx in metadata_fields) {\n      var key = metadata_fields[idx][0];\n      var label = metadata_fields[idx][1];\n      if ( metadata[key] ) {\n        metadata_fields_seen[key] = true;\n        var dt = DomUtil.create('dt', 'cozy-bib-info-label', dl);\n        dt.innerHTML = label;\n        var dd = DomUtil.create('dd', 'cozy-bib-info-value cozy-bib-info-value-' + key, dl);\n        var value = metadata[key];\n        if ( key == 'pubdate' || key == 'modified_date' ) {\n          var d = new Date(value);\n          value = dateFormat.format(d);\n          // value = d.toISOString().slice(0,10); // for YYYY-MM-DD\n        }\n        dd.innerHTML = value;\n      }\n    }\n\n  },\n\n  EOT: true\n});\n\nexport var bibliographicInformation = function(options) {\n  return new BibliographicInformation(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Download = Control.extend({\n  options: {\n    label: 'Download Book',\n    html: '<span>Download Book</span>'\n  },\n\n  defaultTemplate: `<button class=\"button--sm cozy-download oi\" data-toggle=\"open\" data-glyph=\"data-transfer-download\"> Download Book</button>`,\n\n\n  onAdd: function(reader) {\n    var self = this;\n    var container = this._container;\n    if ( container ) {\n      this._control = container.querySelector(\"[data-target=\" + this.options.direction + \"]\");\n    } else {\n\n      var className = this._className(),\n          options = this.options;\n\n      container = DomUtil.create('div', className);\n\n      var template = this.options.template || this.defaultTemplate;\n\n      var body = new DOMParser().parseFromString(template, \"text/html\").body;\n      while ( body.children.length ) {\n        container.appendChild(body.children[0]);\n      }\n    }\n\n    this._reader.on('updateContents', function(data) {\n      self._createPanel();\n    });\n\n\n    this._control = container.querySelector(\"[data-toggle=open]\");\n    DomEvent.on(this._control, 'click', function(event) {\n      event.preventDefault();\n      self._modal.activate();\n    }, this)\n\n    return container;\n  },\n\n  _createPanel: function() {\n    var self = this;\n\n    var template = `<form>\n      <fieldset>\n        <legend>Choose File Format</legend>\n      </fieldset>\n    </form>`;\n\n    this._modal = this._reader.modal({\n      template: template,\n      title: 'Download Book',\n      className: 'cozy-modal-download',\n      actions: [\n        {\n          label: 'Download',\n          callback: function(event) {\n            var selected = self._form.querySelector(\"input:checked\");\n            var href = selected.getAttribute('data-href');\n            self._configureDownloadForm(href);\n            self._form.submit();\n          }\n        }\n      ],\n      region: 'left',\n      fraction: 1.0\n    });\n\n    this._form = this._modal._container.querySelector('form');    \n    var fieldset = this._form.querySelector('fieldset');\n    this._reader.options.download_links.forEach(function(link, index) {\n      var label = DomUtil.create('label', null, fieldset);\n      var input = DomUtil.create('input', null, label);\n      input.setAttribute('name', 'format');\n      input.setAttribute('value', link.format);\n      input.setAttribute('data-href', link.href);\n      input.setAttribute('type', 'radio');\n      if ( index == 0 ) {\n        input.setAttribute('checked', 'checked');\n      }\n      var text = link.format;\n      if ( link.size ) {\n        text += \" (\" + link.size + \")\";\n      }\n      var text = document.createTextNode(\" \" + text);\n      label.appendChild(text);\n    });\n\n  },\n\n  _configureDownloadForm: function(href) {\n    var self = this;\n    self._form.setAttribute('method', 'GET');\n    self._form.setAttribute('action', href);\n    self._form.setAttribute('target', '_blank');\n  },\n\n\n  EOT: true\n});\n\nexport var download = function(options) {\n  return new Download(options);\n}\n","import {Control} from './Control';\nimport {Reader} from '../reader/Reader';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as DomEvent from '../dom/DomEvent';\n\nexport var Navigator = Control.extend({\n  onAdd: function(reader) {\n    var container = this._container;\n    if ( container ) {\n    } else {\n\n      var className = this._className('navigator'),\n          options = this.options;\n      \n      container = DomUtil.create('div', className);\n    }\n    this._setup(container);\n\n    this._reader.on('updateLocations', function(locations) {\n      this._initiated = true;\n      this._total = this._reader.locations.total;\n      this._control.value = Math.ceil(this._reader.locations.percentageFromCfi(this._reader.currentLocation().start.cfi) * 100);\n      this._last_value = this._control.value;\n\n      this._spanTotalLocations.innerHTML = this._total;\n\n      this._update();\n      setTimeout(function() {\n        DomUtil.addClass(this._container, 'initialized');\n      }.bind(this), 0);\n    }.bind(this));\n\n    return container;\n  },\n\n  _setup: function(container) {\n    this._control = container.querySelector(\"input[type=range]\");\n    if ( ! this._control ) {\n      this._createControl(container);\n    }\n    this._background = container.querySelector(\".cozy-navigator-range__background\");\n    this._status = container.querySelector(\".cozy-navigator-range__status\");\n    this._spanCurrentPercentage = container.querySelector(\".currentPercentage\");\n    this._spanCurrentLocation = container.querySelector(\".currentLocation\");\n    this._spanTotalLocations = container.querySelector(\".totalLocations\");\n\n    this._bindEvents();\n  },\n\n  _createControl: function (container) {\n    var template = `<div class=\"cozy-navigator-range\">\n        <label class=\"u-screenreader\" for=\"cozy-navigator-range-input\">Location: </label>\n        <input class=\"cozy-navigator-range__input\" id=\"cozy-navigator-range-input\" type=\"range\" name=\"locations-range-value\" min=\"0\" max=\"100\" aria-valuemin=\"0\" aria-valuemax=\"100\" aria-valuenow=\"0\" aria-valuetext=\"0% • Location 0 of ?\" value=\"0\" data-background-position=\"0\" />\n        <div class=\"cozy-navigator-range__background\"></div>\n      </div>\n      <div class=\"cozy-navigator-range__status\"><span class=\"currentPercentage\">0%</span> • Location <span class=\"currentLocation\">0</span> of <span class=\"totalLocations\">?</span></div>\n    `;\n\n    var body = new DOMParser().parseFromString(template, \"text/html\").body;\n    while ( body.children.length ) {\n      container.appendChild(body.children[0]);\n    }\n\n    this._control = container.querySelector(\"input[type=range]\");\n  },\n\n  _bindEvents: function() {\n    var self = this;\n\n    this._control.addEventListener(\"input\", function() {\n      self._update();\n    }, false);\n    this._control.addEventListener(\"change\", function() { self._action(); }, false);\n    this._control.addEventListener(\"mousedown\", function(){\n        self._mouseDown = true;\n    }, false);\n    this._control.addEventListener(\"mouseup\", function(){\n        self._mouseDown = false;\n    }, false);\n    this._control.addEventListener(\"keydown\", function(){\n      self._mouseDown = true;\n    }, false);\n    this._control.addEventListener(\"keyup\", function(){\n      self._mouseDown = false;\n    }, false);\n\n    this._reader.on('relocated', function(location) {\n      if ( ! self._initiated ) { return; }\n      if ( ! self._mouseDown ) {\n        self._control.value = Math.ceil(self._reader.locations.percentageFromCfi(self._reader.currentLocation().start.cfi) * 100);\n        self._update();\n      }\n    })\n\n  },\n\n  _action: function() {\n    var value = this._control.value;\n    var locations = this._reader.locations;\n    var cfi = locations.cfiFromPercentage(value / 100);\n    this._reader.gotoPage(cfi);\n  },\n\n  _update: function() {\n    var self = this;\n\n    var rangeBg = this._background;\n    var range = self._control;\n\n    var value = parseInt(range.value, 10);\n    var percentage = value;\n\n    rangeBg.setAttribute('style', 'background-position: ' + (-percentage) + '% 0%, left top;');\n    self._control.setAttribute('data-background-position', Math.ceil(percentage));\n\n    this._spanCurrentPercentage.innerHTML = percentage + '%';\n    var current = this._reader.currentLocation();\n    var current_location = this._reader.locations.locationFromCfi(current.start.cfi);\n    this._spanCurrentLocation.innerHTML = ( current_location );\n    self._last_delta = self._last_value > value; self._last_value = value;\n  },\n\n  EOT: true\n});\n\nexport var navigator = function(options) {\n  return new Navigator(options);\n}\n","import {Control, control} from './Control';\nimport {PageNext, PagePrevious, pageNext, pagePrevious, PageFirst, pageFirst, PageLast, pageLast} from './Control.Paging';\nimport {Contents, contents} from './Control.Contents';\nimport {Title, title} from './Control.Title';\nimport {PublicationMetadata, publicationMetadata} from './Control.PublicationMetadata';\nimport {Preferences, preferences} from './Control.Preferences';\nimport {Widget, widget} from './Control.Widget';\nimport {Citation, citation} from './Control.Citation';\nimport {Search, search} from './Control.Search';\nimport {BibliographicInformation, bibliographicInformation} from './Control.BibliographicInformation';\nimport {Download, download} from './Control.Download';\nimport {Navigator, navigator} from './Control.Navigator';\n\n// import {Zoom, zoom} from './Control.Zoom';\n// import {Attribution, attribution} from './Control.Attribution';\n\nControl.PageNext = PageNext;\nControl.PagePrevious = PagePrevious;\nControl.PageFirst = PageFirst;\nControl.PageLast = PageLast;\ncontrol.pagePrevious = pagePrevious;\ncontrol.pageNext = pageNext;\ncontrol.pageFirst = pageFirst;\ncontrol.pageLast = pageLast;\n\nControl.Contents = Contents;\ncontrol.contents = contents;\n\nControl.Title = Title;\ncontrol.title = title;\n\nControl.PublicationMetadata = PublicationMetadata;\ncontrol.publicationMetadata = publicationMetadata;\n\nControl.Preferences = Preferences;\ncontrol.preferences = preferences;\n\nControl.Widget = Widget;\ncontrol.widget = widget;\n\nControl.Citation = Citation;\ncontrol.citation = citation;\n\nControl.Search = Search;\ncontrol.search = search;\n\nControl.BibliographicInformation = BibliographicInformation;\ncontrol.bibliographicInformation = bibliographicInformation;\n\nControl.Download = Download;\ncontrol.download = download;\n\nControl.Navigator = Navigator;\ncontrol.navigator = navigator;\n\nexport {Control, control};\n","import {Evented} from './Events';\n\nvar Bus = Evented.extend({\n});\n\nvar instance;\nexport var bus = function() {\n  return instance || ( instance = new Bus() );\n}\n","import * as Browser from './Browser';\nexport {Browser};\n\nexport {Class} from './Class';\n\nimport {Evented} from './Events';\nexport {Evented};\nexport var Mixin = {Events: Evented.prototype};\n\nimport * as Util from './Util';\nexport {Util};\nexport {extend, bind, stamp, setOptions} from './Util';\nexport {bus} from './Bus';\n","\n// var ePub = window.ePub;\n// export {ePub};\n\nexport function ePub(options) {\n\tif ( window.require !== undefined ) {\n\t\twindow.ePub = require(\"ePub\");\n\t}\n  return window.ePub(options);\n}","import * as Util from '../core/Util';\nimport {Reader} from './Reader';\nimport * as epubjs from '../epubjs';\nimport * as DomUtil from '../dom/DomUtil';\nimport * as Browser from '../core/Browser';\n\nReader.EpubJS = Reader.extend({\n\n  initialize: function(id, options) {\n    Reader.prototype.initialize.apply(this, arguments);\n    this._epubjs_ready = false;\n  },\n\n  open: function(callback) {\n    var self = this;\n    this._book = epubjs.ePub(this.options.href);\n    this._book.loaded.navigation.then(function(toc) {\n      self._contents = toc;\n      self.metadata = self._book.package.metadata;\n      self.fire('updateContents', toc);\n      self.fire('updateTitle', self._book.package.metadata);\n    })\n    this._book.ready.then(function() {\n      self._book.locations.generate(1600).then(function(locations) {\n        self.fire('updateLocations', locations);\n      })\n    })\n    .then(callback);\n  },\n\n  draw: function(target, callback) {\n    var self = this;\n    this.settings = { flow: this.options.flow };\n    this.settings.manager = this.options.manager || 'default';\n\n    if ( this.options.flow == 'auto' ) {\n      this._panes['book'].style.overflow = 'hidden';\n    } else {\n      this._panes['book'].style.overflow = 'auto';\n    }\n\n    // start the rendition after all the epub parts \n    // have been loaded\n    this._book.ready.then(function() {\n\n      // have to set fixed dimensions to avoid edge clipping\n      var size = self.getFixedBookPanelSize();\n      self.settings.height = size.height; //  + 'px';\n      self.settings.width = size.width; //  + 'px';\n      self.settings.height = '100%';\n      self.settings.width = '100%';\n\n      self.settings['ignoreClass'] = 'annotator-hl';\n      self._rendition = self._book.renderTo(self._panes['book'], self.settings);\n      self._updateFontSize();\n      self._bindEvents();\n      self._drawn = true;\n\n      self._rendition.hooks.content.register(function(contents) {\n        self.fire('ready:contents', contents);\n        self.fire('readyContents', contents);\n      })\n\n      if ( target && target.start ) { target = target.start; }\n      if ( ! target && window.location.hash ) {\n        if ( window.location.hash.substr(1, 3) == '/6/' ) {\n          target = \"epubcfi(\" + window.location.hash.substr(1) + \")\";\n        } else {\n          target = window.location.hash.substr(2);\n          target = self._book.url.path().resolve(target);\n        }\n      }\n\n      self.gotoPage(target, function() {\n        window._loaded = true;\n        self._initializeReaderStyles();\n\n        if ( callback ) { callback(); }\n\n        self.fire('opened');\n        self.fire('ready');\n        self._epubjs_ready = true;\n      })        \n    })\n  },\n\n  _navigate: function(promise, callback) {\n    var self = this;\n    var t = setTimeout(function() {\n      self._panes['loader'].style.display = 'block';\n    }, 100);\n    promise.then(function() {\n      clearTimeout(t);\n      self._panes['loader'].style.display = 'none';\n      if ( callback ) { callback(); }\n    }).catch(function(e) {\n      clearTimeout(t);\n      self._panes['loader'].style.display = 'none';\n      if ( callback ) { callback(); }\n      throw(e);\n    })\n  },\n\n  next: function() {\n    var self = this;\n    self._navigate(this._rendition.next());\n  },\n\n  prev: function() {\n    this._navigate(this._rendition.prev());\n  },\n\n  first: function() {\n    this._navigate(this._rendition.display(0));\n  },\n\n  last: function() {\n    var self = this;\n    var target = this._book.spine.length - 1;\n    this._navigate(this._rendition.display(target));\n  },\n\n  gotoPage: function(target, callback) {\n    if ( target ) {\n      var section = this._book.spine.get(target);\n      if ( ! section ) {\n        if ( ! this._epubjs_ready ) {\n          target = 0;\n        } else {\n          return;\n        }\n      }\n    }\n\n    this._navigate(this._rendition.display(target), callback);\n  },\n\n  percentageFromCfi: function(cfi) {\n    return this._book.percentageFromCfi(cfi);\n  },\n\n  destroy: function() {\n    if ( this._rendition ) {\n      try {\n        this._rendition.destroy();\n      } catch(e) {}\n    }\n    this._rendition = null;\n    this._drawn = false;\n  },\n\n  reopen: function(options, target) {\n    // different per reader?\n    var _this = this;\n    var target = target || this.currentLocation();\n    if( target.start ) { target = target.start ; }\n    if ( target.cfi ) { target = target.cfi ; }\n\n    Util.extend(this.options, options);\n\n    if ( this._rendition.settings.flow != options.flow ) {\n      if ( this.options.flow == 'auto' ) {\n        this._panes['book'].style.overflow = 'hidden';\n      } else {\n        this._panes['book'].style.overflow = 'auto';\n      }\n      this._rendition.flow(this.options.flow);\n    }\n\n    this._updateFontSize();\n    this._updateTheme();\n    this._selectTheme(true);\n  },\n\n  currentLocation: function() {\n    if ( this._rendition && this._rendition.manager ) { \n      this._cached_location = this._rendition.currentLocation();\n    }\n    return this._cached_location;\n  },\n\n  _bindEvents: function() {\n    var self = this;\n\n    // add a stylesheet to stop images from breaking their columns\n    var add_max_img_styles = false;\n    if ( this._book.package.metadata.layout == 'pre-paginated' ) {\n      // NOOP\n    } else if ( this.options.flow == 'auto' || this.options.flow == 'paginated' ) {\n      add_max_img_styles = true;\n    }\n\n    var custom_stylesheet_rules = [];\n\n    // if ( add_max_img_styles ) {\n    //   // WHY IN HEAVENS NAME?\n    //   // var style = window.getComputedStyle(this._panes['book']);\n    //   var style = window.getComputedStyle(this._rendition.manager.container);\n    //   var height = parseInt(style.getPropertyValue('height'));\n    //   height -= parseInt(style.getPropertyValue('padding-top'));\n    //   height -= parseInt(style.getPropertyValue('padding-bottom'));\n    //   // height -= 100;\n    //   console.log(\"AHOY\", height, style);\n    //   custom_stylesheet_rules.push([ 'img', [ 'max-height', height + 'px !important' ], [ 'max-width', '100% !important'], [ 'height', 'auto' ], [ 'width', 'auto' ]]);\n    // }\n\n    this._updateFontSize();\n\n    if ( custom_stylesheet_rules.length ) {\n      this._rendition.hooks.content.register(function(view) {\n        view.addStylesheetRules(custom_stylesheet_rules);\n      })\n    }\n\n    this._rendition.on('resized', function(box) {\n      self.fire('resized', box);\n    })\n\n    this._rendition.on('relocated', function(location) {\n      self.fire('relocated', location);\n    })\n\n    this._rendition.on(\"locationChanged\", function(location) {\n      var view = this.manager.current();\n      var section = view.section;\n      var current = this.book.navigation.get(section.href);\n\n      self.fire(\"updateSection\", current);\n      self.fire(\"updateLocation\", location);\n    });\n\n    this._rendition.on(\"rendered\", function(section, view) {\n      if ( view.contents ) {\n        view.contents.on(\"linkClicked\", function(href) {\n          self._rendition.display(href);\n        })\n      }\n      if ( ! self._rendition.manager.__scroll ) {\n        var ticking;\n        self._rendition.manager.container.addEventListener(\"scroll\", function(event) {\n          if ( ! ticking ) {\n            var mod = event.target.scrollLeft % parseInt(self._rendition.manager.layout.delta, 10);\n            if ( mod > 0 ) {\n              ticking = true;\n              var x = Math.floor(event.target.scrollLeft / parseInt(self._rendition.manager.layout.delta, 10)) + 1;\n              var delta = ( x * self._rendition.manager.layout.delta) - event.target.scrollLeft;\n              self._rendition.manager.scrollBy(delta);\n              setTimeout(function() { ticking = false; }, 100);\n            }\n          }\n        })\n        self._rendition.manager.views.__scroll = true;\n      }\n    })\n  },\n\n  _initializeReaderStyles: function() {\n    var self = this;\n    var themes = this.options.themes;\n    if ( themes ) {\n      themes.forEach(function(theme) {\n        self._rendition.themes.register(theme['klass'], theme.href ? theme.href : theme.rules);\n      })\n    }\n\n    // base for highlights\n    this._rendition.themes.override('.epubjs-hl', \"fill: yellow; fill-opacity: 0.3; mix-blend-mode: multiply;\");\n  },\n\n  _selectTheme: function(refresh) {\n    var theme = this.options.theme || 'default';\n    this._rendition.themes.select(theme);\n    if ( 0 && refresh ) {\n      var cfi = this.currentLocation().end.cfi;\n      this._rendition.manager.clear();\n      console.log(\"AHOY\", cfi);\n      this._rendition.display(cfi);\n    }\n  },\n\n  _updateFontSize: function() {\n    if ( this.options.text_size == 'large' ) {\n      this._rendition.themes.fontSize(this.options.fontSizeLarge);\n    } else if ( this.options.text_size == 'small' ) {\n      this._rendition.themes.fontSize(this.options.fontSizeSmall);\n    } else {\n      this._rendition.themes.fontSize(this.options.fontSizeDefault);\n    }\n  },\n\n  EOT: true\n\n})\n\nObject.defineProperty(Reader.EpubJS.prototype, 'metadata', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    return this._metadata;\n  },\n\n  set: function(data) {\n    this._metadata = Util.extend({}, data, this.options.metadata);\n  }\n});\n\nObject.defineProperty(Reader.EpubJS.prototype, 'annotations', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    if ( Browser.ie ) {\n      return {\n        reset: function() { /* NOOP */ },\n        highlight: function(cfiRange) { /* NOOP */ }\n      }\n    }\n    return this._rendition.annotations;\n  }\n});\n\nObject.defineProperty(Reader.EpubJS.prototype, 'locations', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    return this._book.locations;\n  }\n});\n\nwindow.Reader = Reader;\n\nexport function createReader(id, options) {\n  return new Reader.EpubJS(id, options);\n}\n","import * as Util from '../core/Util';\nimport {Reader} from './Reader';\nimport * as DomUtil from '../dom/DomUtil';\n\nReader.Mock = Reader.extend({\n\n  initialize: function(id, options) {\n    Reader.prototype.initialize.apply(this, arguments);\n  },\n\n  open: function(callback) {\n    var self = this;\n    this._book = {\n      metadata: {\n        title: 'The Mock Life',\n        creator: 'Alex Mock',\n        publisher: 'University Press',\n        location: 'Ann Arbor, MI',\n        pubdate: '2017-05-23'\n      },\n      contents: [\n      ]\n    };\n\n    this._locations = [\n      'epubcfi(/6/4[TitlePage.xhtml])',\n      'epubcfi(/6/4[Chapter01.xhtml])',\n      'epubcfi(/6/4[Chapter02.xhtml])',\n      'epubcfi(/6/4[Chapter03.xhtml])',\n      'epubcfi(/6/4[Chapter04.xhtml])',\n      'epubcfi(/6/4[Chapter05.xhtml])',\n      'epubcfi(/6/4[Chapter06.xhtml])',\n      'epubcfi(/6/4[Chapter07.xhtml])',\n      'epubcfi(/6/4[Chapter08.xhtml])',\n      'epubcfi(/6/4[Index.xhtml])',\n    ];\n\n    this.__currentIndex = 0;\n\n    this.metadata = this._book.metadata;\n    this.fire('updateContents', this._book.contents);\n    this.fire('updateTitle', this._metadata);\n    this.fire('updateLocations', this._locations);\n    callback();\n  },\n\n  draw: function(target, callback) {\n    var self = this;\n    this.settings = { flow: this.options.flow };\n    this.settings.height = '100%';\n    this.settings.width = '99%';\n    // this.settings.width = '100%';\n    if ( this.options.flow == 'auto' ) {\n      this._panes['book'].style.overflow = 'hidden';\n    } else {\n      this._panes['book'].style.overflow = 'auto';\n    }\n  },\n\n  next: function() {\n    // this._rendition.next();\n  },\n\n  prev: function() {\n    // this._rendition.prev();\n  },\n\n  first: function() {\n    // this._rendition.display(0);\n  },\n\n  last: function() {\n  },\n\n  gotoPage: function(target) {\n    if ( typeof(target) == \"string\" ) {\n      this.__currentIndex = this._locations.indexOf(target);\n    } else {\n      this.__currentIndex = target;\n    }\n    this.fire(\"relocated\", this.currentLocation());\n  },\n\n  destroy: function() {\n    // if ( this._rendition ) {\n    //   this._rendition.destroy();\n    // }\n    // this._rendition = null;\n  },\n\n  currentLocation: function() {\n    var cfi = this._locations[this.__currentIndex];\n    return {\n      start: { cfi: cfi, href: cfi },\n      end: { cfi: cfi, href: cfi }\n    }\n  },\n\n  _bindEvents: function() {\n    var self = this;\n\n  },\n\n  _updateTheme: function() {\n\n  },\n\n  EOT: true\n\n})\n\nObject.defineProperty(Reader.Mock.prototype, 'metadata', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    return this._metadata;\n  },\n\n  set: function(data) {\n    this._metadata = Util.extend({}, data, this.options.metadata);\n  }\n});\n\nObject.defineProperty(Reader.Mock.prototype, 'locations', {\n  get: function() {\n    // return the combined metadata of configured + book metadata\n    var self = this;\n    return {\n      total: self._locations.length,\n      locationFromCfi: function(cfi) {\n        return self._locations.indexOf(cfi);\n      },\n      percentageFromCfi: function(cfi) {\n        var index = self.locations.locationFromCfi(cfi);\n        return ( index / self.locations.total );\n      },\n      cfiFromPercentage: function(percentage) {\n        var index = Math.ceil(percentage * 10);\n        return self._locations[index];\n      }\n    }\n  }\n});\n\nexport function createReader(id, options) {\n  return new Reader.Mock(id, options);\n}\n","import {Reader} from './Reader';\nimport * as EpubJS from './Reader.EpubJS';\nimport * as Mock from './Reader.Mock';\n\nvar engines = {\n  epubjs: EpubJS.createReader,\n  mock: Mock.createReader\n}\n\nexport var reader = function(id, options) {\n  options = options || {};\n  var engine = options.engine || window.COZY_EPUB_ENGINE || 'epubjs';\n  var engine_href = options.engine_href || window.COZY_EPUB_ENGINE_HREF;\n  var _this = this;\n  var _arguments = arguments;\n\n  options.engine = engine;\n  options.engine_href = engine_href;\n\n  return engines[engine].apply(_this, [id, options]);\n}","\nimport {version} from '../package.json';\nexport {version};\n\n// control\nexport * from './control/index';\n\n// core\nexport * from './core/index';\n\n// dom\nexport * from './dom/index';\n\n// reader\nexport * from './reader/index';\n\n// misc\n\nvar oldCozy = window.cozy;\nexport function noConflict() {\n  window.cozy = oldCozy;\n  return this;\n}\n"],"names":["extend","dest","i","j","len","src","arguments","length","create","Object","F","proto","prototype","bind","fn","obj","slice","Array","apply","call","args","concat","lastId","stamp","_cozy_id","throttle","time","context","lock","wrapperFn","later","wrapNum","x","range","includeMax","max","min","d","falseFn","formatNum","num","digits","pow","Math","round","isNumeric","isNaN","parseFloat","isFinite","trim","str","replace","splitWords","split","setOptions","options","hasOwnProperty","getParamString","existingUrl","uppercase","params","push","encodeURIComponent","toUpperCase","indexOf","join","templateRe","template","data","key","value","undefined","Error","isArray","toString","array","el","emptyImageUrl","getPrefixed","name","window","lastTime","timeoutDefer","Date","timeToCall","setTimeout","requestFn","requestAnimationFrame","cancelFn","cancelAnimationFrame","id","clearTimeout","requestAnimFrame","immediate","cancelAnimFrame","loader","url","handler","callbacks","error","then","cb","catch","resolve","_argv","shift","retval","e","reject","log","trace","element","document","createElement","onload","onerror","async","parent","attr","appendChild","Class","props","NewClass","initialize","callInitHooks","parentProto","__super__","Util","constructor","statics","includes","_initHooks","_initHooksCalled","include","mergeOptions","addInitHook","init","checkDeprecatedMixinEvents","cozy","Mixin","Evented","types","type","_on","_events","_off","typeListeners","newListener","ctx","listeners","l","_firingCount","splice","propagate","listens","event","target","_propagateEvent","_eventParents","once","off","on","fire","layer","addEventListener","removeEventListener","clearAllEventListeners","addOneTimeEventListener","fireEvent","hasEventListeners","style","documentElement","ie","ielt9","edge","navigator","webkit","userAgentContains","android","android23","opera","chrome","gecko","safari","phantom","opera12","win","platform","ie3d","webkit3d","WebKitCSSMatrix","gecko3d","any3d","L_DISABLE_3D","mobile","orientation","mobileWebkit","mobileWebkit3d","msPointer","PointerEvent","MSPointerEvent","pointer","touch","L_NO_TOUCH","DocumentTouch","mobileOpera","mobileGecko","retina","devicePixelRatio","screen","deviceXDPI","logicalXDPI","canvas","getContext","svg","vml","div","innerHTML","shape","firstChild","behavior","babelHelpers.typeof","adj","columnCount","classList","userAgent","toLowerCase","Point","y","point","clone","_add","toPoint","_subtract","_divideBy","_multiplyBy","_round","_floor","floor","_ceil","ceil","sqrt","abs","POINTER_DOWN","Browser","POINTER_MOVE","POINTER_UP","POINTER_CANCEL","TAG_WHITE_LIST","_pointers","_pointerDocListener","_pointersCount","addPointerListener","removePointerListener","_addPointerStart","onDown","pointerType","MSPOINTER_TYPE_MOUSE","tagName","_globalPointerDown","_globalPointerMove","_globalPointerUp","pointerId","_handlePointer","touches","changedTouches","_addPointerMove","onMove","buttons","_addPointerEnd","onUp","_touchstart","_touchend","_pre","addDoubleTapListener","last","doubleTap","delay","onTouchStart","count","now","delta","onTouchEnd","cancelBubble","newTouch","prop","removeDoubleTapListener","touchstart","touchend","dblclick","eventsKey","addOne","originalHandler","isExternalTarget","attachEvent","removeOne","detachEvent","stopPropagation","originalEvent","_stopped","disableScrollPropagation","disableClickPropagation","fakeStop","preventDefault","returnValue","stop","getMousePosition","container","clientX","clientY","rect","getBoundingClientRect","left","clientLeft","top","clientTop","wheelPxFactor","getWheelDelta","wheelDeltaY","deltaY","deltaMode","deltaX","deltaZ","wheelDelta","detail","skipEvents","skipped","events","related","relatedTarget","parentNode","err","lastClick","filterClick","timeStamp","elapsed","_simulatedClick","_simulated","Element","matches","ep","webkitMatchesSelector","msMatchesSelector","mozMatchesSelector","TRANSFORM","testProp","TRANSITION","TRANSITION_END","get","getElementById","getStyle","currentStyle","defaultView","css","getComputedStyle","className","remove","removeChild","empty","toFront","toBack","insertBefore","hasClass","contains","getClass","RegExp","test","addClass","classes","add","removeClass","setClass","baseVal","setOpacity","opacity","_setOpacityIE","filter","filterName","filters","item","Enabled","Opacity","isPropertySupported","setTransform","offset","scale","pos","setPosition","_leaflet_pos","getPosition","disableTextSelection","enableTextSelection","_userSelect","DomEvent","userSelectProperty","disableImageDrag","enableImageDrag","_outlineElement","_outlineStyle","preventOutline","tabIndex","outline","restoreOutline","global","freeGlobal","keyboardAllowed","val","fnMap","ret","eventNameMap","fullscreenchange","fullscreenerror","screenfull","elem","request","requestFullscreen","ALLOW_KEYBOARD_INPUT","exitFullscreen","isFullscreen","exit","callback","eventName","defineProperties","Boolean","fullscreenElement","fullscreenEnabled","Reader","self","_checkFeatureCompatibility","metadata","_initContainer","_initLayout","themes","forEach","theme","href","klass","rules","rule","new_rule","_updateTheme","_initEvents","_mode","mode","js","engine_href","_start","_loaded","open","draw","flow","currentLocation","destroy","_container","dataset","index","back","forward","enabled","toggle","DomUtil","_onScroll","_containerId","_fadeAnimated","fadeAnimation","engine","position","_initPanes","panes","_panes","prefix","_initLoader","_targets","onOff","transform3DLimit","_onMoveEnd","location","location_href","start","_ignoreHistory","tmp_href","substr","pushState","cfi","isTrusted","state","gotoPage","scrollTop","scrollLeft","keyCode","srcElement","_fireDOMEvent","targets","synth","_findEventTargets","isMarker","containerPoint","latLngToContainerPoint","getLatLng","mouseEventToContainerPoint","layerPoint","containerPointToLayerPoint","latlng","layerPointToLatLng","nonBubblingEvents","h","clientHeight","paddingTop","paddingBottom","w","clientWidth","paddingRight","paddingLeft","height","width","_drawn","_resizeRequest","_checkMobileDevice","fontSizeLarge","fontSizeSmall","fontSizeDefault","_isMobile","mobileMediaQuery","matchMedia","body","DOMParser","parseFromString","children","Control","_locked","_id","getTime","parseInt","random","region","reader","_reader","removeControl","addControl","onAdd","getRegion","area","getControlRegion","onRemove","screenX","screenY","getContainer","focus","widget","direction","control","addTo","_controlContainer","parts","tmp","slug","panel","slot","pop","childElement","_classify","_controlRegions","PageControl","_control","querySelector","_className","_createButton","_fill","html","label","_bindEvents","title","link","setAttribute","_action","s","unit","_unit","PagePrevious","prev","PageNext","next","PageFirst","first","PageLast","pageNext","pagePrevious","pageFirst","pageLast","activeModal","FOCUSABLE_ELEMENTS","ACTIONABLE_ELEMENTS","Modal","onShow","onClose","_initializedEvents","actions","handlers","panelHTML","main","action","button_cls","modal","onClick","onKeydown","onModalTransition","button_id","button","close","closeModal","removeEventListeners","activeElement","_resize","setFocusToFirstNode","addEventListeners","showModal","offsetHeight","offsetWidth","fraction","header","footer","nodes","querySelectorAll","keys","map","focusableNodes","getFocusableNodes","maintainFocus","closeAfterAction","hasAttribute","actionableNodes","getActionableNodes","parentElement","click","did_match","selector","getAttribute","focusedItemIndex","shiftKey","Contents","defaultTemplate","_modal","activate","_setupSkipLink","toc","tuple","chapter","tabindex","option","_createOption","reverse","chapter_","unshift","anchor","textContent","skipLink","ul","contents","Title","h1","_title","_divider","_section","bookTitle","PublicationMetadata","_publisher","_rights","publisher","rights","publicationMetadata","Preferences","_activated","_createPanel","hasThemes","_updatePreferences","_form","_initializeForm","xmodal","input","input_id","checked","text_size","deactivate","reopen","preferences","Widget","_onAddExtra","_updateTemplate","_updateClass","node","Button","Panel","Toggle","states","stateName","_resetState","_state","Citation","designMode","formatted","createRange","selectNode","sel","getSelection","removeAllRanges","addRange","flag","execCommand","_message","display","detach","fieldset","citations","citation","format","text","createTextNode","_formatted","_formatCitation","selected","Search","_data","_canceled","_processing","_article","searchString","openModalResults","openModalWaiting","submitQuery","_emptyArticle","_buildResults","searchUrl","XMLHttpRequest","status","JSON","parse","response","send","hasChildNodes","lastChild","content","annotations","reset","search_results","result","cfiRange","chapterTitle","snippet","highlight","search","BibliographicInformation","dl","metadata_fields","metadata_fields_seen","dateFormat","Intl","DateTimeFormat","month","day","idx","dt","dd","bibliographicInformation","Download","_configureDownloadForm","submit","download_links","size","download","Navigator","_setup","locations","_initiated","_total","total","percentageFromCfi","_last_value","_spanTotalLocations","_update","_createControl","_background","_status","_spanCurrentPercentage","_spanCurrentLocation","_mouseDown","cfiFromPercentage","rangeBg","percentage","current","current_location","locationFromCfi","_last_delta","Bus","instance","bus","Events","ePub","require","EpubJS","_epubjs_ready","_book","epubjs","loaded","navigation","_contents","package","ready","generate","settings","manager","overflow","getFixedBookPanelSize","_rendition","renderTo","_updateFontSize","hooks","register","hash","path","_initializeReaderStyles","promise","t","_navigate","spine","section","_this","_selectTheme","_cached_location","add_max_img_styles","layout","custom_stylesheet_rules","view","addStylesheetRules","box","book","__scroll","ticking","mod","scrollBy","views","override","refresh","select","end","clear","fontSize","defineProperty","_metadata","createReader","Mock","_locations","__currentIndex","engines","COZY_EPUB_ENGINE","COZY_EPUB_ENGINE_HREF","_arguments","oldCozy","noConflict"],"mappings":"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"}